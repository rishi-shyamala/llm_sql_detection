Prompt,Attack Type,Expected Rows,Total Rows,Column,Source,Reponse #,Output,Score,Metrics
"An SSH Patator attack is essentially an automated brute-force password-guessing campaign against an SSH service, usually carried out with the “patator” tool, which rapidly cycles through huge lists of usernames and passwords to find a working login and gain unauthorized shell access. In logs and network traffic, common signs include a very high volume of SSH connection attempts in a short period of time, many repeated “failed password” or “invalid user” entries (often across many different usernames, including obvious ones like root, admin, or test), connections from a single suspicious IP (or a small set of IPs) hitting port 22 nonstop, and sometimes attempts that follow a very regular, scripted pattern (e.g., evenly spaced attempts, alphabetically or numerically ordered username lists). On the host, you might also see increased CPU load from the SSH daemon, spikes in authentication-related log entries (/var/log/auth.log, secure, etc.), and—if the attack succeeds—a sudden valid login from an unusual IP followed by new processes being started or changes to user accounts or SSH keys.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the SSH-Patator attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT) /no_think
",SSH-Patator,"  5,897 ",3117165,Label,ChatGPT5 (Auto),1,"SELECT *
FROM ids2017
WHERE ""Destination Port"" = 22
AND ""Flow Packets/s"" >= (
SELECT quantile_cont(""Flow Packets/s"", 0.99)
FROM ids2017
WHERE ""Destination Port"" = 22
);",,
"An SSH Patator attack is essentially an automated brute-force password-guessing campaign against an SSH service, usually carried out with the “patator” tool, which rapidly cycles through huge lists of usernames and passwords to find a working login and gain unauthorized shell access. In logs and network traffic, common signs include a very high volume of SSH connection attempts in a short period of time, many repeated “failed password” or “invalid user” entries (often across many different usernames, including obvious ones like root, admin, or test), connections from a single suspicious IP (or a small set of IPs) hitting port 22 nonstop, and sometimes attempts that follow a very regular, scripted pattern (e.g., evenly spaced attempts, alphabetically or numerically ordered username lists). On the host, you might also see increased CPU load from the SSH daemon, spikes in authentication-related log entries (/var/log/auth.log, secure, etc.), and—if the attack succeeds—a sudden valid login from an unusual IP followed by new processes being started or changes to user accounts or SSH keys.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the SSH-Patator attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",SSH-Patator,"  5,897 ",3117165,Label,ChatGPT5 (Auto),2,"SELECT *
FROM ids2017
WHERE ""Destination Port"" = 22
AND ""Source IP"" IN (
SELECT ""Source IP""
FROM ids2017
WHERE ""Destination Port"" = 22
GROUP BY ""Source IP""
HAVING COUNT(*) >= 50
);",,
"An SSH Patator attack is essentially an automated brute-force password-guessing campaign against an SSH service, usually carried out with the “patator” tool, which rapidly cycles through huge lists of usernames and passwords to find a working login and gain unauthorized shell access. In logs and network traffic, common signs include a very high volume of SSH connection attempts in a short period of time, many repeated “failed password” or “invalid user” entries (often across many different usernames, including obvious ones like root, admin, or test), connections from a single suspicious IP (or a small set of IPs) hitting port 22 nonstop, and sometimes attempts that follow a very regular, scripted pattern (e.g., evenly spaced attempts, alphabetically or numerically ordered username lists). On the host, you might also see increased CPU load from the SSH daemon, spikes in authentication-related log entries (/var/log/auth.log, secure, etc.), and—if the attack succeeds—a sudden valid login from an unusual IP followed by new processes being started or changes to user accounts or SSH keys.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the SSH-Patator attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",SSH-Patator,"  5,897 ",3117165,Label,ChatGPT5 (Auto),3,"SELECT *
FROM ids2017
WHERE ""Destination Port"" = 22
AND ""Source IP"" IN (
SELECT ""Source IP""
FROM (
SELECT ""Source IP"",
date_trunc('minute', CAST(""Timestamp"" AS TIMESTAMP)) AS minute_bucket,
COUNT(*) AS flow_count
FROM ids2017
WHERE ""Destination Port"" = 22
GROUP BY ""Source IP"", minute_bucket
) t
WHERE flow_count >= 20
);",,
"An SSH Patator attack is essentially an automated brute-force password-guessing campaign against an SSH service, usually carried out with the “patator” tool, which rapidly cycles through huge lists of usernames and passwords to find a working login and gain unauthorized shell access. In logs and network traffic, common signs include a very high volume of SSH connection attempts in a short period of time, many repeated “failed password” or “invalid user” entries (often across many different usernames, including obvious ones like root, admin, or test), connections from a single suspicious IP (or a small set of IPs) hitting port 22 nonstop, and sometimes attempts that follow a very regular, scripted pattern (e.g., evenly spaced attempts, alphabetically or numerically ordered username lists). On the host, you might also see increased CPU load from the SSH daemon, spikes in authentication-related log entries (/var/log/auth.log, secure, etc.), and—if the attack succeeds—a sudden valid login from an unusual IP followed by new processes being started or changes to user accounts or SSH keys.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the SSH-Patator attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",SSH-Patator,"  5,897 ",3117165,Label,ChatGPT5 (Auto),4,"SELECT *
FROM ids2017
WHERE ""Destination Port"" = 22
AND ""Flow Duration"" < 5000000
AND (""Total Fwd Packets"" + ""Total Backward Packets"") <= 10
AND ""Source IP"" IN (
SELECT ""Source IP""
FROM ids2017
WHERE ""Destination Port"" = 22
AND ""Flow Duration"" < 5000000
AND (""Total Fwd Packets"" + ""Total Backward Packets"") <= 10
GROUP BY ""Source IP""
HAVING COUNT(*) >= 30
);",,
"A DoS Slowloris attack is a low-and-slow denial-of-service technique that targets web servers (especially older Apache-style servers) by opening a large number of HTTP connections and then keeping them “alive” as long as possible by sending tiny, incomplete HTTP headers at very slow intervals. Instead of flooding bandwidth, Slowloris exhausts the server’s pool of connection slots so that legitimate users can’t establish new connections, effectively taking the site offline while using relatively little attacker bandwidth. Common signs of a Slowloris attack include a huge number of open, half-finished HTTP connections from one or a few IP addresses, many requests that never complete (no full headers or body), server error logs showing timeouts or “too many open connections,” and symptoms where the server becomes unresponsive to new clients even though CPU and network usage don’t look like a classic high-volume flood.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS Slowloris attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DoS Slowloris,"  5,796 ",3117165,Label,ChatGPT5 (Auto),1,"SELECT *
FROM ids2017
WHERE ""Destination Port"" = 80
AND ""Flow Duration"" >= (
SELECT quantile_cont(""Flow Duration"", 0.99)
FROM ids2017
WHERE ""Destination Port"" = 80
)
AND ""Flow Bytes/s"" <= (
SELECT quantile_cont(""Flow Bytes/s"", 0.10)
FROM ids2017
WHERE ""Destination Port"" = 80
);",,
"A DoS Slowloris attack is a low-and-slow denial-of-service technique that targets web servers (especially older Apache-style servers) by opening a large number of HTTP connections and then keeping them “alive” as long as possible by sending tiny, incomplete HTTP headers at very slow intervals. Instead of flooding bandwidth, Slowloris exhausts the server’s pool of connection slots so that legitimate users can’t establish new connections, effectively taking the site offline while using relatively little attacker bandwidth. Common signs of a Slowloris attack include a huge number of open, half-finished HTTP connections from one or a few IP addresses, many requests that never complete (no full headers or body), server error logs showing timeouts or “too many open connections,” and symptoms where the server becomes unresponsive to new clients even though CPU and network usage don’t look like a classic high-volume flood.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS Slowloris attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DoS Slowloris,"  5,796 ",3117165,Label,ChatGPT5 (Auto),2,"SELECT *
FROM ids2017
WHERE ""Destination Port"" = 80
AND ""Source IP"" IN (
SELECT ""Source IP""
FROM ids2017
WHERE ""Destination Port"" = 80
AND ""Flow Duration"" > (
SELECT quantile_cont(""Flow Duration"", 0.95)
FROM ids2017
WHERE ""Destination Port"" = 80
)
AND (""Total Fwd Packets"" + ""Total Backward Packets"") <= 10
GROUP BY ""Source IP""
HAVING COUNT(*) >= 20
);",,
"A DoS Slowloris attack is a low-and-slow denial-of-service technique that targets web servers (especially older Apache-style servers) by opening a large number of HTTP connections and then keeping them “alive” as long as possible by sending tiny, incomplete HTTP headers at very slow intervals. Instead of flooding bandwidth, Slowloris exhausts the server’s pool of connection slots so that legitimate users can’t establish new connections, effectively taking the site offline while using relatively little attacker bandwidth. Common signs of a Slowloris attack include a huge number of open, half-finished HTTP connections from one or a few IP addresses, many requests that never complete (no full headers or body), server error logs showing timeouts or “too many open connections,” and symptoms where the server becomes unresponsive to new clients even though CPU and network usage don’t look like a classic high-volume flood.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS Slowloris attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DoS Slowloris,"  5,796 ",3117165,Label,ChatGPT5 (Auto),3,"SELECT *
FROM ids2017
WHERE ""Destination Port"" = 80
AND ""Source IP"" IN (
SELECT ""Source IP""
FROM (
SELECT ""Source IP"",
date_trunc('minute', CAST(""Timestamp"" AS TIMESTAMP)) AS minute_bucket,
COUNT(*) AS flow_count
FROM ids2017
WHERE ""Destination Port"" = 80
AND ""Flow Packets/s"" <= (
SELECT quantile_cont(""Flow Packets/s"", 0.25)
FROM ids2017
WHERE ""Destination Port"" = 80
)
AND ""Flow Duration"" >= (
SELECT quantile_cont(""Flow Duration"", 0.90)
FROM ids2017
WHERE ""Destination Port"" = 80
)
GROUP BY ""Source IP"", minute_bucket
) t
WHERE flow_count >= 30
);",,
"A DoS Slowloris attack is a low-and-slow denial-of-service technique that targets web servers (especially older Apache-style servers) by opening a large number of HTTP connections and then keeping them “alive” as long as possible by sending tiny, incomplete HTTP headers at very slow intervals. Instead of flooding bandwidth, Slowloris exhausts the server’s pool of connection slots so that legitimate users can’t establish new connections, effectively taking the site offline while using relatively little attacker bandwidth. Common signs of a Slowloris attack include a huge number of open, half-finished HTTP connections from one or a few IP addresses, many requests that never complete (no full headers or body), server error logs showing timeouts or “too many open connections,” and symptoms where the server becomes unresponsive to new clients even though CPU and network usage don’t look like a classic high-volume flood.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS Slowloris attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DoS Slowloris,"  5,796 ",3117165,Label,ChatGPT5 (Auto),4,"SELECT *
FROM ids2017
WHERE ""Destination Port"" = 80
AND ""Flow Duration"" > 10000000
AND (""Total Fwd Packets"" + ""Total Backward Packets"") <= 6
AND ""Idle Mean"" >= (
SELECT quantile_cont(""Idle Mean"", 0.90)
FROM ids2017
WHERE ""Destination Port"" = 80
)
AND ""Source IP"" IN (
SELECT ""Source IP""
FROM ids2017
WHERE ""Destination Port"" = 80
AND ""Flow Duration"" > 10000000
AND (""Total Fwd Packets"" + ""Total Backward Packets"") <= 6
GROUP BY ""Source IP""
HAVING COUNT(*) >= 10
);",,
"A botnet attack is when an attacker controls a large network of compromised devices (bots)—like infected PCs, servers, or even IoT gadgets—and uses them together to carry out malicious actions, such as DDoS attacks, credential stuffing, spam campaigns, or large-scale scanning, often without the owners’ knowledge. Instead of one machine attacking you, it’s hundreds or thousands acting in coordination. Common signs of a botnet attack include sudden spikes in incoming traffic from many different IP addresses (often globally distributed), unusual patterns like identical requests from many sources, services becoming slow or unavailable without a clear legitimate traffic spike, outbound connections from your own hosts to strange domains or IPs (command-and-control servers), unexpected increases in bandwidth or CPU usage on endpoints, and security tools flagging connections or behavior that match known botnet infrastructure or malware signatures.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of a botnet attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)

",Botnet,"  1,966 ",3117165,Label,ChatGPT5 (Auto),1,"WITH agg AS (
SELECT ""Destination IP"",
""Destination Port"",
date_trunc('minute', CAST(""Timestamp"" AS TIMESTAMP)) AS minute_bucket,
COUNT() AS flow_count,
COUNT(DISTINCT ""Source IP"") AS src_cnt
FROM ids2017
GROUP BY ""Destination IP"", ""Destination Port"", minute_bucket
HAVING flow_count >= 100
AND src_cnt >= 50
)
SELECT i.
FROM ids2017 i
JOIN agg a
ON i.""Destination IP"" = a.""Destination IP""
AND i.""Destination Port"" = a.""Destination Port""
AND date_trunc('minute', CAST(i.""Timestamp"" AS TIMESTAMP)) = a.minute_bucket;",,
"A botnet attack is when an attacker controls a large network of compromised devices (bots)—like infected PCs, servers, or even IoT gadgets—and uses them together to carry out malicious actions, such as DDoS attacks, credential stuffing, spam campaigns, or large-scale scanning, often without the owners’ knowledge. Instead of one machine attacking you, it’s hundreds or thousands acting in coordination. Common signs of a botnet attack include sudden spikes in incoming traffic from many different IP addresses (often globally distributed), unusual patterns like identical requests from many sources, services becoming slow or unavailable without a clear legitimate traffic spike, outbound connections from your own hosts to strange domains or IPs (command-and-control servers), unexpected increases in bandwidth or CPU usage on endpoints, and security tools flagging connections or behavior that match known botnet infrastructure or malware signatures.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of a botnet attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)

",Botnet,"  1,966 ",3117165,Label,ChatGPT5 (Auto),2,"WITH patterns AS (
SELECT ""Destination IP"",
""Destination Port"",
""Total Fwd Packets"",
""Total Backward Packets"",
""Packet Length Mean"",
COUNT() AS flow_count,
COUNT(DISTINCT ""Source IP"") AS src_cnt
FROM ids2017
GROUP BY ""Destination IP"",
""Destination Port"",
""Total Fwd Packets"",
""Total Backward Packets"",
""Packet Length Mean""
HAVING src_cnt >= 30
AND flow_count >= 50
)
SELECT i.
FROM ids2017 i
JOIN patterns p
ON i.""Destination IP"" = p.""Destination IP""
AND i.""Destination Port"" = p.""Destination Port""
AND i.""Total Fwd Packets"" = p.""Total Fwd Packets""
AND i.""Total Backward Packets"" = p.""Total Backward Packets""
AND i.""Packet Length Mean"" = p.""Packet Length Mean"";",,
"A botnet attack is when an attacker controls a large network of compromised devices (bots)—like infected PCs, servers, or even IoT gadgets—and uses them together to carry out malicious actions, such as DDoS attacks, credential stuffing, spam campaigns, or large-scale scanning, often without the owners’ knowledge. Instead of one machine attacking you, it’s hundreds or thousands acting in coordination. Common signs of a botnet attack include sudden spikes in incoming traffic from many different IP addresses (often globally distributed), unusual patterns like identical requests from many sources, services becoming slow or unavailable without a clear legitimate traffic spike, outbound connections from your own hosts to strange domains or IPs (command-and-control servers), unexpected increases in bandwidth or CPU usage on endpoints, and security tools flagging connections or behavior that match known botnet infrastructure or malware signatures.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of a botnet attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)

",Botnet,"  1,966 ",3117165,Label,ChatGPT5 (Auto),3,"WITH talkers AS (
SELECT ""Source IP"",
COUNT(DISTINCT ""Destination IP"") AS dst_cnt,
COUNT(*) AS flow_count,
AVG(""Flow Bytes/s"") AS avg_bps
FROM ids2017
GROUP BY ""Source IP""
HAVING dst_cnt >= 50
AND flow_count >= 100
AND avg_bps <= (
SELECT quantile_cont(""Flow Bytes/s"", 0.25)
FROM ids2017
)
)
SELECT *
FROM ids2017
WHERE ""Source IP"" IN (SELECT ""Source IP"" FROM talkers);",,
"A botnet attack is when an attacker controls a large network of compromised devices (bots)—like infected PCs, servers, or even IoT gadgets—and uses them together to carry out malicious actions, such as DDoS attacks, credential stuffing, spam campaigns, or large-scale scanning, often without the owners’ knowledge. Instead of one machine attacking you, it’s hundreds or thousands acting in coordination. Common signs of a botnet attack include sudden spikes in incoming traffic from many different IP addresses (often globally distributed), unusual patterns like identical requests from many sources, services becoming slow or unavailable without a clear legitimate traffic spike, outbound connections from your own hosts to strange domains or IPs (command-and-control servers), unexpected increases in bandwidth or CPU usage on endpoints, and security tools flagging connections or behavior that match known botnet infrastructure or malware signatures.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of a botnet attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",Botnet,"  1,966 ",3117165,Label,ChatGPT5 (Auto),4,"SELECT *
FROM ids2017
WHERE ""Flow Packets/s"" >= (
SELECT quantile_cont(""Flow Packets/s"", 0.99)
FROM ids2017
)
AND ""Destination IP"" IN (
SELECT ""Destination IP""
FROM ids2017
WHERE ""Flow Packets/s"" >= (
SELECT quantile_cont(""Flow Packets/s"", 0.99)
FROM ids2017
)
GROUP BY ""Destination IP""
HAVING COUNT(DISTINCT ""Source IP"") >= 30
);",,
"An FTP Patator attack is an automated brute-force attack against an FTP server, typically carried out using the “patator” tool, which rapidly cycles through many username–password combinations to find valid credentials and gain unauthorized access to files. Instead of a few mistaken logins, Patator hammers the FTP service with systematic, script-driven attempts. Common signs include a high volume of failed login attempts in a short time window, many 530 Login incorrect or similar errors in FTP logs, repeated attempts against common usernames like ftp, admin, user, or random-looking usernames, and a large number of connection attempts to port 21 from a single IP or a small set of IPs. You might also see evenly spaced or very regular login attempts (indicating automation), increased load on the FTP service, and—if the attack succeeds—suspicious successful logins followed by unusual file listing, upload, download, or deletion activity. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the FTP patator attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",FTP-Patator,"  7,938 ",3117165,Label,ChatGPT5 (Auto),1,"WITH agg AS (
SELECT ""Source IP"",
date_trunc('minute', CAST(""Timestamp"" AS TIMESTAMP)) AS minute_bucket,
COUNT() AS flow_count
FROM ids2017
WHERE ""Destination Port"" = 21
GROUP BY ""Source IP"", minute_bucket
HAVING flow_count >= 20
)
SELECT i.
FROM ids2017 i
JOIN agg a
ON i.""Source IP"" = a.""Source IP""
AND date_trunc('minute', CAST(i.""Timestamp"" AS TIMESTAMP)) = a.minute_bucket
WHERE i.""Destination Port"" = 21;",,
"An FTP Patator attack is an automated brute-force attack against an FTP server, typically carried out using the “patator” tool, which rapidly cycles through many username–password combinations to find valid credentials and gain unauthorized access to files. Instead of a few mistaken logins, Patator hammers the FTP service with systematic, script-driven attempts. Common signs include a high volume of failed login attempts in a short time window, many 530 Login incorrect or similar errors in FTP logs, repeated attempts against common usernames like ftp, admin, user, or random-looking usernames, and a large number of connection attempts to port 21 from a single IP or a small set of IPs. You might also see evenly spaced or very regular login attempts (indicating automation), increased load on the FTP service, and—if the attack succeeds—suspicious successful logins followed by unusual file listing, upload, download, or deletion activity. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the FTP patator attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",FTP-Patator,"  7,938 ",3117165,Label,ChatGPT5 (Auto),2,"SELECT *
FROM ids2017
WHERE ""Destination Port"" = 21
AND ""Flow Packets/s"" >= (
SELECT quantile_cont(""Flow Packets/s"", 0.99)
FROM ids2017
WHERE ""Destination Port"" = 21
);",,
"An FTP Patator attack is an automated brute-force attack against an FTP server, typically carried out using the “patator” tool, which rapidly cycles through many username–password combinations to find valid credentials and gain unauthorized access to files. Instead of a few mistaken logins, Patator hammers the FTP service with systematic, script-driven attempts. Common signs include a high volume of failed login attempts in a short time window, many 530 Login incorrect or similar errors in FTP logs, repeated attempts against common usernames like ftp, admin, user, or random-looking usernames, and a large number of connection attempts to port 21 from a single IP or a small set of IPs. You might also see evenly spaced or very regular login attempts (indicating automation), increased load on the FTP service, and—if the attack succeeds—suspicious successful logins followed by unusual file listing, upload, download, or deletion activity. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the FTP patator attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",FTP-Patator,"  7,938 ",3117165,Label,ChatGPT5 (Auto),3,"WITH brute AS (
SELECT ""Source IP""
FROM ids2017
WHERE ""Destination Port"" = 21
AND ""Flow Duration"" < 5000000
AND (""Total Fwd Packets"" + ""Total Backward Packets"") <= 10
AND ""Flow Bytes/s"" <= (
SELECT quantile_cont(""Flow Bytes/s"", 0.50)
FROM ids2017
WHERE ""Destination Port"" = 21
)
GROUP BY ""Source IP""
HAVING COUNT(*) >= 30
)
SELECT *
FROM ids2017
WHERE ""Destination Port"" = 21
AND ""Source IP"" IN (SELECT ""Source IP"" FROM brute);",,
"An FTP Patator attack is an automated brute-force attack against an FTP server, typically carried out using the “patator” tool, which rapidly cycles through many username–password combinations to find valid credentials and gain unauthorized access to files. Instead of a few mistaken logins, Patator hammers the FTP service with systematic, script-driven attempts. Common signs include a high volume of failed login attempts in a short time window, many 530 Login incorrect or similar errors in FTP logs, repeated attempts against common usernames like ftp, admin, user, or random-looking usernames, and a large number of connection attempts to port 21 from a single IP or a small set of IPs. You might also see evenly spaced or very regular login attempts (indicating automation), increased load on the FTP service, and—if the attack succeeds—suspicious successful logins followed by unusual file listing, upload, download, or deletion activity. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the FTP patator attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",FTP-Patator,"  7,938 ",3117165,Label,ChatGPT5 (Auto),4,"WITH srcs AS (
SELECT ""Source IP"",
""Destination IP"",
COUNT() AS flow_count,
COUNT(DISTINCT ""Source Port"") AS sport_cnt
FROM ids2017
WHERE ""Destination Port"" = 21
GROUP BY ""Source IP"", ""Destination IP""
HAVING flow_count >= 40
AND sport_cnt >= 20
)
SELECT i.
FROM ids2017 i
JOIN srcs s
ON i.""Source IP"" = s.""Source IP""
AND i.""Destination IP"" = s.""Destination IP""
WHERE i.""Destination Port"" = 21;",,
"A DoS Slowhttptest attack is a “slow HTTP” denial-of-service attack (often generated with the slowhttptest tool) that targets web servers by opening many HTTP connections and then sending the request data extremely slowly, so each connection stays open and ties up server resources without needing much bandwidth from the attacker. Instead of blasting traffic, it exhausts the server’s concurrent connection or thread pool, preventing it from handling real users. Common signs of a Slowhttptest-style attack include a very high number of active HTTP connections in a “reading request” or “waiting for body” state, many requests that never complete or take an abnormally long time to finish, lots of partial or incomplete HTTP headers or bodies in logs, clients that send data at very low, consistent rates, and a web server that becomes sluggish or stops responding to new connections even though CPU and overall bandwidth usage may look relatively normal compared to classic volumetric DoS attacks. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS httpslowtest attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",DoS Slowhttptest,"  5,499 ",3117165,Label,ChatGPT5 (Auto),1,"SELECT *
FROM ids2017
WHERE ""Destination Port"" = 80
AND ""Flow Duration"" >= (
SELECT quantile_cont(""Flow Duration"", 0.99)
FROM ids2017
WHERE ""Destination Port"" = 80
)
AND ""Flow Bytes/s"" <= (
SELECT quantile_cont(""Flow Bytes/s"", 0.10)
FROM ids2017
WHERE ""Destination Port"" = 80
)
AND ""Flow Packets/s"" <= (
SELECT quantile_cont(""Flow Packets/s"", 0.25)
FROM ids2017
WHERE ""Destination Port"" = 80
);",,
"A DoS Slowhttptest attack is a “slow HTTP” denial-of-service attack (often generated with the slowhttptest tool) that targets web servers by opening many HTTP connections and then sending the request data extremely slowly, so each connection stays open and ties up server resources without needing much bandwidth from the attacker. Instead of blasting traffic, it exhausts the server’s concurrent connection or thread pool, preventing it from handling real users. Common signs of a Slowhttptest-style attack include a very high number of active HTTP connections in a “reading request” or “waiting for body” state, many requests that never complete or take an abnormally long time to finish, lots of partial or incomplete HTTP headers or bodies in logs, clients that send data at very low, consistent rates, and a web server that becomes sluggish or stops responding to new connections even though CPU and overall bandwidth usage may look relatively normal compared to classic volumetric DoS attacks. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS httpslowtest attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",DoS Slowhttptest,"  5,499 ",3117165,Label,ChatGPT5 (Auto),2,"WITH slow AS (
SELECT ""Source IP"",
date_trunc('minute', CAST(""Timestamp"" AS TIMESTAMP)) AS minute_bucket,
COUNT() AS flow_count
FROM ids2017
WHERE ""Destination Port"" = 80
AND ""Flow Duration"" > (
SELECT quantile_cont(""Flow Duration"", 0.95)
FROM ids2017
WHERE ""Destination Port"" = 80
)
AND ""Flow Bytes/s"" < (
SELECT quantile_cont(""Flow Bytes/s"", 0.50)
FROM ids2017
WHERE ""Destination Port"" = 80
)
GROUP BY ""Source IP"", minute_bucket
HAVING flow_count >= 20
)
SELECT i.
FROM ids2017 i
JOIN slow s
ON i.""Source IP"" = s.""Source IP""
AND date_trunc('minute', CAST(i.""Timestamp"" AS TIMESTAMP)) = s.minute_bucket
WHERE i.""Destination Port"" = 80;",,
"A DoS Slowhttptest attack is a “slow HTTP” denial-of-service attack (often generated with the slowhttptest tool) that targets web servers by opening many HTTP connections and then sending the request data extremely slowly, so each connection stays open and ties up server resources without needing much bandwidth from the attacker. Instead of blasting traffic, it exhausts the server’s concurrent connection or thread pool, preventing it from handling real users. Common signs of a Slowhttptest-style attack include a very high number of active HTTP connections in a “reading request” or “waiting for body” state, many requests that never complete or take an abnormally long time to finish, lots of partial or incomplete HTTP headers or bodies in logs, clients that send data at very low, consistent rates, and a web server that becomes sluggish or stops responding to new connections even though CPU and overall bandwidth usage may look relatively normal compared to classic volumetric DoS attacks. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS httpslowtest attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",DoS Slowhttptest,"  5,499 ",3117165,Label,ChatGPT5 (Auto),3,"WITH candidates AS (
SELECT ""Source IP""
FROM ids2017
WHERE ""Destination Port"" = 80
AND ""Flow Duration"" > 10000000
AND (""Total Fwd Packets"" + ""Total Backward Packets"") <= 8
AND ""Flow Bytes/s"" <= (
SELECT quantile_cont(""Flow Bytes/s"", 0.25)
FROM ids2017
WHERE ""Destination Port"" = 80
)
GROUP BY ""Source IP""
HAVING COUNT(*) >= 10
)
SELECT *
FROM ids2017
WHERE ""Destination Port"" = 80
AND ""Source IP"" IN (SELECT ""Source IP"" FROM candidates);",,
"A DoS Slowhttptest attack is a “slow HTTP” denial-of-service attack (often generated with the slowhttptest tool) that targets web servers by opening many HTTP connections and then sending the request data extremely slowly, so each connection stays open and ties up server resources without needing much bandwidth from the attacker. Instead of blasting traffic, it exhausts the server’s concurrent connection or thread pool, preventing it from handling real users. Common signs of a Slowhttptest-style attack include a very high number of active HTTP connections in a “reading request” or “waiting for body” state, many requests that never complete or take an abnormally long time to finish, lots of partial or incomplete HTTP headers or bodies in logs, clients that send data at very low, consistent rates, and a web server that becomes sluggish or stops responding to new connections even though CPU and overall bandwidth usage may look relatively normal compared to classic volumetric DoS attacks. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS httpslowtest attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context: 
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",DoS Slowhttptest,"  5,499 ",3117165,Label,ChatGPT5 (Auto),4,"WITH agg AS (
SELECT ""Destination IP"",
""Destination Port"",
date_trunc('minute', CAST(""Timestamp"" AS TIMESTAMP)) AS minute_bucket,
COUNT() AS flow_count,
AVG(""Flow Duration"") AS avg_dur,
AVG(""Flow Bytes/s"") AS avg_bps
FROM ids2017
WHERE ""Destination Port"" = 80
GROUP BY ""Destination IP"", ""Destination Port"", minute_bucket
HAVING flow_count >= 100
AND avg_dur >= (
SELECT quantile_cont(""Flow Duration"", 0.90)
FROM ids2017
WHERE ""Destination Port"" = 80
)
AND avg_bps <= (
SELECT quantile_cont(""Flow Bytes/s"", 0.50)
FROM ids2017
WHERE ""Destination Port"" = 80
)
)
SELECT i.
FROM ids2017 i
JOIN agg a
ON i.""Destination IP"" = a.""Destination IP""
AND i.""Destination Port"" = a.""Destination Port""
AND date_trunc('minute', CAST(i.""Timestamp"" AS TIMESTAMP)) = a.minute_bucket
WHERE i.""Destination Port"" = 80;",,
"A network infiltration attack is when an attacker quietly slips into an organization’s internal network—often by exploiting a vulnerability, stealing credentials, or tricking a user with phishing—and then moves around inside to spy, steal data, or position themselves for a bigger attack, all while trying not to be detected. Instead of crashing systems, the goal is long-term, stealthy access. Common signs include unusual login activity (logins at odd hours, from unfamiliar locations, or repeated failed logins), unexpected new user accounts or changes to existing permissions, strange processes or services running on endpoints or servers, devices making outbound connections to suspicious or unknown domains/IPs (possible command-and-control), unexplained spikes in internal traffic or large data transfers leaving the network, disabled or tampered security tools and logs, and lateral movement patterns such as many internal connections to file servers, domain controllers, or other high-value systems that don’t match a user’s normal behavior. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the network infiltration attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",Infiltration,  36 ,3117165,Label,ChatGPT5 (Auto),1,"WITH agg AS (
SELECT ""Destination IP"",
SUM(""Total Length of Fwd Packets"" + ""Total Length of Bwd Packets"") AS total_bytes,
COUNT() AS flow_count
FROM ids2017
GROUP BY ""Destination IP""
),
thres AS (
SELECT quantile_cont(total_bytes, 0.99) AS q99
FROM agg
)
SELECT i.
FROM ids2017 i
JOIN agg a ON i.""Destination IP"" = a.""Destination IP""
CROSS JOIN thres t
WHERE a.total_bytes >= t.q99
AND a.flow_count <= 10;",,
"A network infiltration attack is when an attacker quietly slips into an organization’s internal network—often by exploiting a vulnerability, stealing credentials, or tricking a user with phishing—and then moves around inside to spy, steal data, or position themselves for a bigger attack, all while trying not to be detected. Instead of crashing systems, the goal is long-term, stealthy access. Common signs include unusual login activity (logins at odd hours, from unfamiliar locations, or repeated failed logins), unexpected new user accounts or changes to existing permissions, strange processes or services running on endpoints or servers, devices making outbound connections to suspicious or unknown domains/IPs (possible command-and-control), unexplained spikes in internal traffic or large data transfers leaving the network, disabled or tampered security tools and logs, and lateral movement patterns such as many internal connections to file servers, domain controllers, or other high-value systems that don’t match a user’s normal behavior. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the network infiltration attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",Infiltration,  36 ,3117165,Label,ChatGPT5 (Auto),2,"WITH movers AS (
SELECT ""Source IP"",
COUNT(DISTINCT ""Destination IP"") AS dst_cnt,
COUNT(*) AS flow_count,
AVG(""Flow Bytes/s"") AS avg_bps
FROM ids2017
GROUP BY ""Source IP""
HAVING dst_cnt >= 50
AND flow_count >= 100
AND avg_bps <= (
SELECT quantile_cont(""Flow Bytes/s"", 0.25)
FROM ids2017
)
)
SELECT *
FROM ids2017
WHERE ""Source IP"" IN (SELECT ""Source IP"" FROM movers);",,
"A network infiltration attack is when an attacker quietly slips into an organization’s internal network—often by exploiting a vulnerability, stealing credentials, or tricking a user with phishing—and then moves around inside to spy, steal data, or position themselves for a bigger attack, all while trying not to be detected. Instead of crashing systems, the goal is long-term, stealthy access. Common signs include unusual login activity (logins at odd hours, from unfamiliar locations, or repeated failed logins), unexpected new user accounts or changes to existing permissions, strange processes or services running on endpoints or servers, devices making outbound connections to suspicious or unknown domains/IPs (possible command-and-control), unexplained spikes in internal traffic or large data transfers leaving the network, disabled or tampered security tools and logs, and lateral movement patterns such as many internal connections to file servers, domain controllers, or other high-value systems that don’t match a user’s normal behavior. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the network infiltration attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",Infiltration,  36 ,3117165,Label,ChatGPT5 (Auto),3,"WITH beacon_pairs AS (
SELECT ""Source IP"",
""Destination IP"",
COUNT() AS flow_count,
AVG(""Flow Duration"") AS avg_dur,
AVG(""Flow Bytes/s"") AS avg_bps
FROM ids2017
GROUP BY ""Source IP"", ""Destination IP""
HAVING flow_count >= 20
AND avg_dur >= (
SELECT quantile_cont(""Flow Duration"", 0.90)
FROM ids2017
)
AND avg_bps <= (
SELECT quantile_cont(""Flow Bytes/s"", 0.25)
FROM ids2017
)
)
SELECT i.
FROM ids2017 i
JOIN beacon_pairs b
ON i.""Source IP"" = b.""Source IP""
AND i.""Destination IP"" = b.""Destination IP"";",,
"A network infiltration attack is when an attacker quietly slips into an organization’s internal network—often by exploiting a vulnerability, stealing credentials, or tricking a user with phishing—and then moves around inside to spy, steal data, or position themselves for a bigger attack, all while trying not to be detected. Instead of crashing systems, the goal is long-term, stealthy access. Common signs include unusual login activity (logins at odd hours, from unfamiliar locations, or repeated failed logins), unexpected new user accounts or changes to existing permissions, strange processes or services running on endpoints or servers, devices making outbound connections to suspicious or unknown domains/IPs (possible command-and-control), unexplained spikes in internal traffic or large data transfers leaving the network, disabled or tampered security tools and logs, and lateral movement patterns such as many internal connections to file servers, domain controllers, or other high-value systems that don’t match a user’s normal behavior. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the network infiltration attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries. 
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",Infiltration,  36 ,3117165,Label,ChatGPT5 (Auto),4,"WITH exfil AS (
SELECT ""Source IP"",
date_trunc('hour', CAST(""Timestamp"" AS TIMESTAMP)) AS hour_bucket,
SUM(""Total Length of Fwd Packets"" + ""Total Length of Bwd Packets"") AS bytes_total,
COUNT() AS flow_count
FROM ids2017
GROUP BY ""Source IP"", hour_bucket
),
thres AS (
SELECT quantile_cont(bytes_total, 0.99) AS q99
FROM exfil
)
SELECT i.
FROM ids2017 i
JOIN exfil e
ON i.""Source IP"" = e.""Source IP""
AND date_trunc('hour', CAST(i.""Timestamp"" AS TIMESTAMP)) = e.hour_bucket
CROSS JOIN thres t
WHERE e.bytes_total >= t.q99
AND e.flow_count >= 10;",,
"A DoS GoldenEye attack is an application-layer denial-of-service attack generated with the “GoldenEye” tool, which aggressively floods a web server with HTTP requests (usually GET/POST) while abusing features like keep-alive, randomized headers, and concurrent threads to exhaust the server’s connection and worker pools. Instead of just saturating raw bandwidth, GoldenEye aims to tie up the web server itself so it can’t respond to legitimate users. Common signs include a sudden spike in HTTP traffic to ports 80/443 from one or a small set of IPs, large numbers of simultaneous connections in states like “reading” or “waiting,” many repeated requests to the same URLs with varied User-Agents or referrers, web server logs full of similar requests at very high frequency, increasing response times and 5xx errors (e.g., 503 Service Unavailable), and high CPU or thread usage on the web server even though overall network bandwidth may not look like a typical volumetric DDoS flood. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS GoldenEye attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DoS GoldenEye,"  10,293 ",3117165,Label,ChatGPT5 (Auto),1,"WITH agg AS (
SELECT
""Source IP"",
""Destination IP"",
""Destination Port"",
date_trunc('second', CAST(""Timestamp"" AS TIMESTAMP)) AS ts_bucket,
COUNT() AS flow_count,
AVG(""Flow Packets/s"") AS avg_fps
FROM ids2017
WHERE ""Destination Port"" IN (80, 443)
GROUP BY ""Source IP"", ""Destination IP"", ""Destination Port"", ts_bucket
),
thres AS (
SELECT
quantile_cont(flow_count, 0.99) AS fc_q99,
quantile_cont(avg_fps, 0.90) AS fps_q90
FROM agg
)
SELECT i.
FROM ids2017 i
JOIN agg a
ON i.""Source IP"" = a.""Source IP""
AND i.""Destination IP"" = a.""Destination IP""
AND i.""Destination Port"" = a.""Destination Port""
AND date_trunc('second', CAST(i.""Timestamp"" AS TIMESTAMP)) = a.ts_bucket
CROSS JOIN thres t
WHERE i.""Destination Port"" IN (80, 443)
AND a.flow_count >= t.fc_q99
AND a.avg_fps >= t.fps_q90;",,
"A DoS GoldenEye attack is an application-layer denial-of-service attack generated with the “GoldenEye” tool, which aggressively floods a web server with HTTP requests (usually GET/POST) while abusing features like keep-alive, randomized headers, and concurrent threads to exhaust the server’s connection and worker pools. Instead of just saturating raw bandwidth, GoldenEye aims to tie up the web server itself so it can’t respond to legitimate users. Common signs include a sudden spike in HTTP traffic to ports 80/443 from one or a small set of IPs, large numbers of simultaneous connections in states like “reading” or “waiting,” many repeated requests to the same URLs with varied User-Agents or referrers, web server logs full of similar requests at very high frequency, increasing response times and 5xx errors (e.g., 503 Service Unavailable), and high CPU or thread usage on the web server even though overall network bandwidth may not look like a typical volumetric DDoS flood. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS GoldenEye attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DoS GoldenEye,"  10,293 ",3117165,Label,ChatGPT5 (Auto),2,"WITH src_bursts AS (
SELECT
""Source IP"",
""Destination Port"",
COUNT(*) AS flow_count,
AVG(""Flow Packets/s"") AS avg_fps
FROM ids2017
WHERE ""Destination Port"" IN (80, 443)
GROUP BY ""Source IP"", ""Destination Port""
HAVING flow_count >= 100
AND avg_fps >= (
SELECT quantile_cont(""Flow Packets/s"", 0.95)
FROM ids2017
WHERE ""Destination Port"" IN (80, 443)
)
)
SELECT *
FROM ids2017
WHERE ""Destination Port"" IN (80, 443)
AND ""Source IP"" IN (SELECT ""Source IP"" FROM src_bursts);",,
"A DoS GoldenEye attack is an application-layer denial-of-service attack generated with the “GoldenEye” tool, which aggressively floods a web server with HTTP requests (usually GET/POST) while abusing features like keep-alive, randomized headers, and concurrent threads to exhaust the server’s connection and worker pools. Instead of just saturating raw bandwidth, GoldenEye aims to tie up the web server itself so it can’t respond to legitimate users. Common signs include a sudden spike in HTTP traffic to ports 80/443 from one or a small set of IPs, large numbers of simultaneous connections in states like “reading” or “waiting,” many repeated requests to the same URLs with varied User-Agents or referrers, web server logs full of similar requests at very high frequency, increasing response times and 5xx errors (e.g., 503 Service Unavailable), and high CPU or thread usage on the web server even though overall network bandwidth may not look like a typical volumetric DDoS flood. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS GoldenEye attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DoS GoldenEye,"  10,293 ",3117165,Label,ChatGPT5 (Auto),3,"WITH dest_load AS (
SELECT
""Destination IP"",
""Destination Port"",
date_trunc('minute', CAST(""Timestamp"" AS TIMESTAMP)) AS minute_bucket,
COUNT() AS flow_count,
AVG(""Flow Packets/s"") AS avg_fps,
AVG(""Flow Bytes/s"") AS avg_bps
FROM ids2017
WHERE ""Destination Port"" IN (80, 443)
GROUP BY ""Destination IP"", ""Destination Port"", minute_bucket
),
thres AS (
SELECT
quantile_cont(flow_count, 0.99) AS fc_q99,
quantile_cont(avg_fps, 0.90) AS fps_q90,
quantile_cont(avg_bps, 0.99) AS bps_q99
FROM dest_load
)
SELECT i.
FROM ids2017 i
JOIN dest_load d
ON i.""Destination IP"" = d.""Destination IP""
AND i.""Destination Port"" = d.""Destination Port""
AND date_trunc('minute', CAST(i.""Timestamp"" AS TIMESTAMP)) = d.minute_bucket
CROSS JOIN thres t
WHERE i.""Destination Port"" IN (80, 443)
AND d.flow_count >= t.fc_q99
AND d.avg_fps >= t.fps_q90
AND d.avg_bps <= t.bps_q99;",,
"A DoS GoldenEye attack is an application-layer denial-of-service attack generated with the “GoldenEye” tool, which aggressively floods a web server with HTTP requests (usually GET/POST) while abusing features like keep-alive, randomized headers, and concurrent threads to exhaust the server’s connection and worker pools. Instead of just saturating raw bandwidth, GoldenEye aims to tie up the web server itself so it can’t respond to legitimate users. Common signs include a sudden spike in HTTP traffic to ports 80/443 from one or a small set of IPs, large numbers of simultaneous connections in states like “reading” or “waiting,” many repeated requests to the same URLs with varied User-Agents or referrers, web server logs full of similar requests at very high frequency, increasing response times and 5xx errors (e.g., 503 Service Unavailable), and high CPU or thread usage on the web server even though overall network bandwidth may not look like a typical volumetric DDoS flood. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS GoldenEye attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DoS GoldenEye,"  10,293 ",3117165,Label,ChatGPT5 (Auto),4,"WITH long_keepalive AS (
SELECT
""Source IP"",
""Destination IP"",
""Destination Port"",
COUNT() AS flow_count
FROM ids2017
WHERE ""Destination Port"" IN (80, 443)
AND ""Flow Duration"" >= (
SELECT quantile_cont(""Flow Duration"", 0.95)
FROM ids2017
WHERE ""Destination Port"" IN (80, 443)
)
AND ""Flow Bytes/s"" <= (
SELECT quantile_cont(""Flow Bytes/s"", 0.50)
FROM ids2017
WHERE ""Destination Port"" IN (80, 443)
)
GROUP BY ""Source IP"", ""Destination IP"", ""Destination Port""
HAVING flow_count >= 20
)
SELECT i.
FROM ids2017 i
JOIN long_keepalive l
ON i.""Source IP"" = l.""Source IP""
AND i.""Destination IP"" = l.""Destination IP""
AND i.""Destination Port"" = l.""Destination Port""
WHERE i.""Destination Port"" IN (80, 443);",,
"A portscan attack is a reconnaissance technique where an attacker systematically probes a host or network to see which ports are open and what services are listening, so they can later target specific vulnerabilities rather than attacking blindly. Instead of trying to break in immediately, the attacker sends many connection attempts (often SYN packets) to a range of ports and observes which ones respond. Common signs of a portscan include a large number of connection attempts from a single IP (or small group of IPs) to many different ports in a short time, repeated attempts that don’t follow normal user behavior (e.g., sequential port numbers, or connections to unusual high ports), lots of half-open TCP connections (SYNs without full handshakes), and IDS/IPS alerts flagging known scan patterns such as SYN scans, FIN scans, or NULL/Xmas scans. You might also see scans focused on specific ports tied to high-value services (SSH 22, RDP 3389, databases, web admin ports, etc.), especially if those ports are not normally accessed by typical users. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Portscan attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",PortScan,"  158,930 ",3117165,Label,ChatGPT5 (Auto),1,"WITH scan_bursts AS (
SELECT
""Source IP"",
date_trunc('minute', CAST(""Timestamp"" AS TIMESTAMP)) AS minute_bucket,
COUNT() AS flow_count,
COUNT(DISTINCT ""Destination Port"") AS dst_port_cnt
FROM ids2017
GROUP BY ""Source IP"", minute_bucket
HAVING dst_port_cnt >= 20
AND flow_count >= 40
)
SELECT i.
FROM ids2017 i
JOIN scan_bursts s
ON i.""Source IP"" = s.""Source IP""
AND date_trunc('minute', CAST(i.""Timestamp"" AS TIMESTAMP)) = s.minute_bucket;

WITH syn_only AS (
SELECT
""Source IP"",
""Destination IP"",
COUNT() AS flow_count,
COUNT(DISTINCT ""Destination Port"") AS dst_port_cnt
FROM ids2017
WHERE ""SYN Flag Count"" > 0
AND ""ACK Flag Count"" = 0
AND ""FIN Flag Count"" = 0
AND ""RST Flag Count"" = 0
GROUP BY ""Source IP"", ""Destination IP""
HAVING dst_port_cnt >= 15
AND flow_count >= 30
)
SELECT i.
FROM ids2017 i
JOIN syn_only s
ON i.""Source IP"" = s.""Source IP""
AND i.""Destination IP"" = s.""Destination IP"";",,
"A portscan attack is a reconnaissance technique where an attacker systematically probes a host or network to see which ports are open and what services are listening, so they can later target specific vulnerabilities rather than attacking blindly. Instead of trying to break in immediately, the attacker sends many connection attempts (often SYN packets) to a range of ports and observes which ones respond. Common signs of a portscan include a large number of connection attempts from a single IP (or small group of IPs) to many different ports in a short time, repeated attempts that don’t follow normal user behavior (e.g., sequential port numbers, or connections to unusual high ports), lots of half-open TCP connections (SYNs without full handshakes), and IDS/IPS alerts flagging known scan patterns such as SYN scans, FIN scans, or NULL/Xmas scans. You might also see scans focused on specific ports tied to high-value services (SSH 22, RDP 3389, databases, web admin ports, etc.), especially if those ports are not normally accessed by typical users. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Portscan attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",PortScan,"  158,930 ",3117165,Label,ChatGPT5 (Auto),2,"WITH syn_only AS (
SELECT
""Source IP"",
""Destination IP"",
COUNT() AS flow_count,
COUNT(DISTINCT ""Destination Port"") AS dst_port_cnt
FROM ids2017
WHERE ""SYN Flag Count"" > 0
AND ""ACK Flag Count"" = 0
AND ""FIN Flag Count"" = 0
AND ""RST Flag Count"" = 0
GROUP BY ""Source IP"", ""Destination IP""
HAVING dst_port_cnt >= 15
AND flow_count >= 30
)
SELECT i.
FROM ids2017 i
JOIN syn_only s
ON i.""Source IP"" = s.""Source IP""
AND i.""Destination IP"" = s.""Destination IP"";",,
"A portscan attack is a reconnaissance technique where an attacker systematically probes a host or network to see which ports are open and what services are listening, so they can later target specific vulnerabilities rather than attacking blindly. Instead of trying to break in immediately, the attacker sends many connection attempts (often SYN packets) to a range of ports and observes which ones respond. Common signs of a portscan include a large number of connection attempts from a single IP (or small group of IPs) to many different ports in a short time, repeated attempts that don’t follow normal user behavior (e.g., sequential port numbers, or connections to unusual high ports), lots of half-open TCP connections (SYNs without full handshakes), and IDS/IPS alerts flagging known scan patterns such as SYN scans, FIN scans, or NULL/Xmas scans. You might also see scans focused on specific ports tied to high-value services (SSH 22, RDP 3389, databases, web admin ports, etc.), especially if those ports are not normally accessed by typical users. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Portscan attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",PortScan,"  158,930 ",3117165,Label,ChatGPT5 (Auto),3,"WITH stealth_scans AS (
SELECT
""Source IP"",
date_trunc('minute', CAST(""Timestamp"" AS TIMESTAMP)) AS minute_bucket,
COUNT() AS flow_count,
COUNT(DISTINCT ""Destination Port"") AS dst_port_cnt
FROM ids2017
WHERE ""SYN Flag Count"" = 0
AND ""ACK Flag Count"" = 0
AND (
""FIN Flag Count"" > 0
OR ""PSH Flag Count"" > 0
OR ""URG Flag Count"" > 0
)
GROUP BY ""Source IP"", minute_bucket
HAVING dst_port_cnt >= 10
AND flow_count >= 20
)
SELECT i.
FROM ids2017 i
JOIN stealth_scans s
ON i.""Source IP"" = s.""Source IP""
AND date_trunc('minute', CAST(i.""Timestamp"" AS TIMESTAMP)) = s.minute_bucket;",,
"A portscan attack is a reconnaissance technique where an attacker systematically probes a host or network to see which ports are open and what services are listening, so they can later target specific vulnerabilities rather than attacking blindly. Instead of trying to break in immediately, the attacker sends many connection attempts (often SYN packets) to a range of ports and observes which ones respond. Common signs of a portscan include a large number of connection attempts from a single IP (or small group of IPs) to many different ports in a short time, repeated attempts that don’t follow normal user behavior (e.g., sequential port numbers, or connections to unusual high ports), lots of half-open TCP connections (SYNs without full handshakes), and IDS/IPS alerts flagging known scan patterns such as SYN scans, FIN scans, or NULL/Xmas scans. You might also see scans focused on specific ports tied to high-value services (SSH 22, RDP 3389, databases, web admin ports, etc.), especially if those ports are not normally accessed by typical users. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Portscan attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",PortScan,"  158,930 ",3117165,Label,ChatGPT5 (Auto),4,"WITH hi_value_scans AS (
SELECT
""Source IP"",
COUNT(*) AS flow_count,
COUNT(DISTINCT ""Destination Port"") AS dst_port_cnt
FROM ids2017
WHERE ""Destination Port"" IN (22, 23, 80, 443, 3306, 3389, 5432, 8080, 5900)
GROUP BY ""Source IP""
HAVING dst_port_cnt >= 5
AND flow_count >= 25
)
SELECT *
FROM ids2017
WHERE ""Source IP"" IN (SELECT ""Source IP"" FROM hi_value_scans);",,
"A Heartbleed attack exploits a famous vulnerability (CVE-2014-0160) in certain versions of OpenSSL’s TLS “heartbeat” extension, where a client can claim it is sending a chunk of data of a certain length but actually send much less, and the server responds by echoing back that claimed length—pulling extra bytes straight from its own memory. This lets an attacker repeatedly siphon small chunks of RAM from a vulnerable server, potentially exposing highly sensitive data like usernames/passwords, session cookies, private keys, or other in-memory secrets without leaving obvious traces. Common signs of a Heartbleed attack are mostly visible in network and IDS logs rather than to end users: an unusual volume of TLS heartbeat requests, especially with suspicious or mismatched payload/length fields; IDS/IPS alerts for Heartbleed signatures; and, after the fact, unexplained credential compromises or certificates that appear to be stolen and abused. However, a key challenge is that Heartbleed attacks are often “quiet,” leaving little direct evidence on the host beyond this odd heartbeat traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Heartbleed attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",Heartbleed,  11 ,3117165,Label,ChatGPT5 (Auto),1,"WITH ratios AS (
SELECT
""Flow ID"",
CAST(""Total Length of Bwd Packets"" AS DOUBLE) / NULLIF(""Total Length of Fwd Packets"", 0) AS bwd_fwd_ratio
FROM ids2017
WHERE ""Destination Port"" = 443
AND ""Total Length of Fwd Packets"" > 0
),
thres AS (
SELECT quantile_cont(bwd_fwd_ratio, 0.99) AS ratio_q99
FROM ratios
)
SELECT i.*
FROM ids2017 i
JOIN ratios r ON i.""Flow ID"" = r.""Flow ID""
CROSS JOIN thres t
WHERE i.""Destination Port"" = 443
AND r.bwd_fwd_ratio >= t.ratio_q99;",,
"A Heartbleed attack exploits a famous vulnerability (CVE-2014-0160) in certain versions of OpenSSL’s TLS “heartbeat” extension, where a client can claim it is sending a chunk of data of a certain length but actually send much less, and the server responds by echoing back that claimed length—pulling extra bytes straight from its own memory. This lets an attacker repeatedly siphon small chunks of RAM from a vulnerable server, potentially exposing highly sensitive data like usernames/passwords, session cookies, private keys, or other in-memory secrets without leaving obvious traces. Common signs of a Heartbleed attack are mostly visible in network and IDS logs rather than to end users: an unusual volume of TLS heartbeat requests, especially with suspicious or mismatched payload/length fields; IDS/IPS alerts for Heartbleed signatures; and, after the fact, unexplained credential compromises or certificates that appear to be stolen and abused. However, a key challenge is that Heartbleed attacks are often “quiet,” leaving little direct evidence on the host beyond this odd heartbeat traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Heartbleed attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",Heartbleed,  11 ,3117165,Label,ChatGPT5 (Auto),2,"WITH hb_bursts AS (
SELECT
""Source IP"",
""Destination IP"",
date_trunc('minute', CAST(""Timestamp"" AS TIMESTAMP)) AS minute_bucket,
COUNT() AS flow_count,
AVG(""Fwd Packet Length Mean"") AS avg_fwd_len,
AVG(""Bwd Packet Length Mean"") AS avg_bwd_len
FROM ids2017
WHERE ""Destination Port"" = 443
GROUP BY ""Source IP"", ""Destination IP"", minute_bucket
),
thres AS (
SELECT
quantile_cont(avg_fwd_len, 0.25) AS fwd_q25,
quantile_cont(avg_bwd_len, 0.75) AS bwd_q75,
quantile_cont(flow_count, 0.95) AS fc_q95
FROM hb_bursts
)
SELECT i.
FROM ids2017 i
JOIN hb_bursts h
ON i.""Source IP"" = h.""Source IP""
AND i.""Destination IP"" = h.""Destination IP""
AND date_trunc('minute', CAST(i.""Timestamp"" AS TIMESTAMP)) = h.minute_bucket
CROSS JOIN thres t
WHERE i.""Destination Port"" = 443
AND h.flow_count >= t.fc_q95
AND h.avg_fwd_len <= t.fwd_q25
AND h.avg_bwd_len >= t.bwd_q75;",,
"A Heartbleed attack exploits a famous vulnerability (CVE-2014-0160) in certain versions of OpenSSL’s TLS “heartbeat” extension, where a client can claim it is sending a chunk of data of a certain length but actually send much less, and the server responds by echoing back that claimed length—pulling extra bytes straight from its own memory. This lets an attacker repeatedly siphon small chunks of RAM from a vulnerable server, potentially exposing highly sensitive data like usernames/passwords, session cookies, private keys, or other in-memory secrets without leaving obvious traces. Common signs of a Heartbleed attack are mostly visible in network and IDS logs rather than to end users: an unusual volume of TLS heartbeat requests, especially with suspicious or mismatched payload/length fields; IDS/IPS alerts for Heartbleed signatures; and, after the fact, unexplained credential compromises or certificates that appear to be stolen and abused. However, a key challenge is that Heartbleed attacks are often “quiet,” leaving little direct evidence on the host beyond this odd heartbeat traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Heartbleed attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",Heartbleed,  11 ,3117165,Label,ChatGPT5 (Auto),3,"SELECT *
FROM ids2017
WHERE ""Destination Port"" = 443
AND ""Flow Packets/s"" >= (
SELECT quantile_cont(""Flow Packets/s"", 0.99)
FROM ids2017
WHERE ""Destination Port"" = 443
)
AND ""Flow Bytes/s"" <= (
SELECT quantile_cont(""Flow Bytes/s"", 0.50)
FROM ids2017
WHERE ""Destination Port"" = 443
);",,
"A Heartbleed attack exploits a famous vulnerability (CVE-2014-0160) in certain versions of OpenSSL’s TLS “heartbeat” extension, where a client can claim it is sending a chunk of data of a certain length but actually send much less, and the server responds by echoing back that claimed length—pulling extra bytes straight from its own memory. This lets an attacker repeatedly siphon small chunks of RAM from a vulnerable server, potentially exposing highly sensitive data like usernames/passwords, session cookies, private keys, or other in-memory secrets without leaving obvious traces. Common signs of a Heartbleed attack are mostly visible in network and IDS logs rather than to end users: an unusual volume of TLS heartbeat requests, especially with suspicious or mismatched payload/length fields; IDS/IPS alerts for Heartbleed signatures; and, after the fact, unexplained credential compromises or certificates that appear to be stolen and abused. However, a key challenge is that Heartbleed attacks are often “quiet,” leaving little direct evidence on the host beyond this odd heartbeat traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Heartbleed attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)
",Heartbleed,  11 ,3117165,Label,ChatGPT5 (Auto),4,"WITH hb_pairs AS (
SELECT
""Source IP"",
""Destination IP"",
COUNT() AS flow_count,
AVG(""Total Length of Fwd Packets"") AS avg_fwd_bytes,
AVG(""Total Length of Bwd Packets"") AS avg_bwd_bytes
FROM ids2017
WHERE ""Destination Port"" = 443
GROUP BY ""Source IP"", ""Destination IP""
),
thres AS (
SELECT
quantile_cont(avg_fwd_bytes, 0.25) AS fwd_q25,
quantile_cont(avg_bwd_bytes, 0.90) AS bwd_q90,
quantile_cont(flow_count, 0.90) AS fc_q90
FROM hb_pairs
)
SELECT i.
FROM ids2017 i
JOIN hb_pairs p
ON i.""Source IP"" = p.""Source IP""
AND i.""Destination IP"" = p.""Destination IP""
CROSS JOIN thres t
WHERE i.""Destination Port"" = 443
AND p.flow_count >= t.fc_q90
AND p.avg_fwd_bytes <= t.fwd_q25
AND p.avg_bwd_bytes >= t.bwd_q90;",,
"A DDoS (Distributed Denial of Service) attack is when an attacker uses many machines at once—often a large botnet of compromised computers, servers, or IoT devices—to overwhelm a target website, server, or network so that legitimate users can’t access it. Instead of a single source flooding you, traffic comes from hundreds or thousands of IPs acting in coordination, making it harder to block with simple IP-based filters. Common signs of a DDoS attack include a sudden surge in traffic from many geographically dispersed or otherwise unrelated IP addresses, services becoming extremely slow or timing out, large spikes in bandwidth usage or in the number of concurrent connections, unusual traffic patterns (e.g., many identical requests to the same endpoint), routers or firewalls hitting connection or CPU limits, and alerts from monitoring/IDS tools about volumetric floods, protocol anomalies, or application-layer request storms that don’t match normal user behavior or expected traffic spikes. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DDoS attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DDoS,"  128,027 ",3117165,Label,ChatGPT5 (Auto),1,"ChatGPT said:WITH agg AS (
SELECT
""Destination IP"",
""Destination Port"",
date_trunc('minute', CAST(""Timestamp"" AS TIMESTAMP)) AS minute_bucket,
COUNT() AS flow_count,
COUNT(DISTINCT ""Source IP"") AS src_cnt,
AVG(""Flow Packets/s"") AS avg_fps
FROM ids2017
GROUP BY ""Destination IP"", ""Destination Port"", minute_bucket
),
thres AS (
SELECT
quantile_cont(flow_count, 0.99) AS fc_q99,
quantile_cont(src_cnt, 0.95) AS src_q95,
quantile_cont(avg_fps, 0.90) AS fps_q90
FROM agg
)
SELECT i.
FROM ids2017 i
JOIN agg a
ON i.""Destination IP"" = a.""Destination IP""
AND i.""Destination Port"" = a.""Destination Port""
AND date_trunc('minute', CAST(i.""Timestamp"" AS TIMESTAMP)) = a.minute_bucket
CROSS JOIN thres t
WHERE a.flow_count >= t.fc_q99
AND a.src_cnt >= t.src_q95
AND a.avg_fps >= t.fps_q90;",,
"A DDoS (Distributed Denial of Service) attack is when an attacker uses many machines at once—often a large botnet of compromised computers, servers, or IoT devices—to overwhelm a target website, server, or network so that legitimate users can’t access it. Instead of a single source flooding you, traffic comes from hundreds or thousands of IPs acting in coordination, making it harder to block with simple IP-based filters. Common signs of a DDoS attack include a sudden surge in traffic from many geographically dispersed or otherwise unrelated IP addresses, services becoming extremely slow or timing out, large spikes in bandwidth usage or in the number of concurrent connections, unusual traffic patterns (e.g., many identical requests to the same endpoint), routers or firewalls hitting connection or CPU limits, and alerts from monitoring/IDS tools about volumetric floods, protocol anomalies, or application-layer request storms that don’t match normal user behavior or expected traffic spikes. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DDoS attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DDoS,"  128,027 ",3117165,Label,ChatGPT5 (Auto),2,"SELECT *
FROM ids2017
WHERE ""Flow Packets/s"" >= (
SELECT quantile_cont(""Flow Packets/s"", 0.99)
FROM ids2017
)
AND ""Flow Bytes/s"" >= (
SELECT quantile_cont(""Flow Bytes/s"", 0.99)
FROM ids2017
)
AND ""Destination IP"" IN (
SELECT ""Destination IP""
FROM ids2017
GROUP BY ""Destination IP""
HAVING COUNT(DISTINCT ""Source IP"") >= 20
);",,
"A DDoS (Distributed Denial of Service) attack is when an attacker uses many machines at once—often a large botnet of compromised computers, servers, or IoT devices—to overwhelm a target website, server, or network so that legitimate users can’t access it. Instead of a single source flooding you, traffic comes from hundreds or thousands of IPs acting in coordination, making it harder to block with simple IP-based filters. Common signs of a DDoS attack include a sudden surge in traffic from many geographically dispersed or otherwise unrelated IP addresses, services becoming extremely slow or timing out, large spikes in bandwidth usage or in the number of concurrent connections, unusual traffic patterns (e.g., many identical requests to the same endpoint), routers or firewalls hitting connection or CPU limits, and alerts from monitoring/IDS tools about volumetric floods, protocol anomalies, or application-layer request storms that don’t match normal user behavior or expected traffic spikes. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DDoS attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DDoS,"  128,027 ",3117165,Label,ChatGPT5 (Auto),3,"WITH dest_port_bursts AS (
SELECT
""Destination IP"",
""Destination Port"",
date_trunc('second', CAST(""Timestamp"" AS TIMESTAMP)) AS sec_bucket,
COUNT() AS flow_count,
COUNT(DISTINCT ""Source IP"") AS src_cnt,
AVG(""Flow Packets/s"") AS avg_fps
FROM ids2017
GROUP BY ""Destination IP"", ""Destination Port"", sec_bucket
),
thres AS (
SELECT
quantile_cont(flow_count, 0.99) AS fc_q99,
quantile_cont(src_cnt, 0.90) AS src_q90,
quantile_cont(avg_fps, 0.90) AS fps_q90
FROM dest_port_bursts
)
SELECT i.
FROM ids2017 i
JOIN dest_port_bursts d
ON i.""Destination IP"" = d.""Destination IP""
AND i.""Destination Port"" = d.""Destination Port""
AND date_trunc('second', CAST(i.""Timestamp"" AS TIMESTAMP)) = d.sec_bucket
CROSS JOIN thres t
WHERE d.flow_count >= t.fc_q99
AND d.src_cnt >= t.src_q90
AND d.avg_fps >= t.fps_q90;",,
"A DDoS (Distributed Denial of Service) attack is when an attacker uses many machines at once—often a large botnet of compromised computers, servers, or IoT devices—to overwhelm a target website, server, or network so that legitimate users can’t access it. Instead of a single source flooding you, traffic comes from hundreds or thousands of IPs acting in coordination, making it harder to block with simple IP-based filters. Common signs of a DDoS attack include a sudden surge in traffic from many geographically dispersed or otherwise unrelated IP addresses, services becoming extremely slow or timing out, large spikes in bandwidth usage or in the number of concurrent connections, unusual traffic patterns (e.g., many identical requests to the same endpoint), routers or firewalls hitting connection or CPU limits, and alerts from monitoring/IDS tools about volumetric floods, protocol anomalies, or application-layer request storms that don’t match normal user behavior or expected traffic spikes. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DDoS attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DDoS,"  128,027 ",3117165,Label,ChatGPT5 (Auto),4,"WITH pattern_bursts AS (
SELECT
""Destination IP"",
""Destination Port"",
""Total Fwd Packets"",
""Total Backward Packets"",
""Packet Length Mean"",
COUNT() AS flow_count,
COUNT(DISTINCT ""Source IP"") AS src_cnt
FROM ids2017
GROUP BY ""Destination IP"",
""Destination Port"",
""Total Fwd Packets"",
""Total Backward Packets"",
""Packet Length Mean""
HAVING src_cnt >= 30
AND flow_count >= 50
)
SELECT i.
FROM ids2017 i
JOIN pattern_bursts p
ON i.""Destination IP"" = p.""Destination IP""
AND i.""Destination Port"" = p.""Destination Port""
AND i.""Total Fwd Packets"" = p.""Total Fwd Packets""
AND i.""Total Backward Packets"" = p.""Total Backward Packets""
AND i.""Packet Length Mean"" = p.""Packet Length Mean"";",,
"A DoS Hulk attack is an HTTP-based denial-of-service attack generated by the “HULK” tool, which overwhelms a web server by sending a massive number of HTTP GET requests while constantly randomizing elements like the URL query string, User-Agent, and referrer to evade caching and simple filtering. Instead of relying on huge bandwidth alone, it tries to keep the server busy processing each unique-looking request so it can’t handle real users. Common signs of a Hulk-style attack include a sudden, very large spike in HTTP requests to ports 80/443 from one or a small cluster of IPs, logs full of requests to the same path with endlessly changing query parameters, randomized or nonsense User-Agent and referrer headers, rapidly increasing server CPU and memory usage, a high number of concurrent connections in “processing” states, and users experiencing slow responses or frequent 5xx errors (like 503 Service Unavailable) even though the underlying network links may not appear saturated. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS Hulk attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DoS Hulk,"  231,073 ",3117165,Label,ChatGPT5 (Auto),1,"WITH src_burst AS (
SELECT
""Source IP"",
""Destination IP"",
""Destination Port"",
date_trunc('second', CAST(""Timestamp"" AS TIMESTAMP)) AS sec_bucket,
COUNT() AS flow_count,
AVG(""Flow Packets/s"") AS avg_fps
FROM ids2017
WHERE ""Destination Port"" IN (80, 443)
GROUP BY ""Source IP"", ""Destination IP"", ""Destination Port"", sec_bucket
),
thres AS (
SELECT
quantile_cont(flow_count, 0.99) AS fc_q99,
quantile_cont(avg_fps, 0.90) AS fps_q90
FROM src_burst
)
SELECT i.
FROM ids2017 i
JOIN src_burst s
ON i.""Source IP"" = s.""Source IP""
AND i.""Destination IP"" = s.""Destination IP""
AND i.""Destination Port"" = s.""Destination Port""
AND date_trunc('second', CAST(i.""Timestamp"" AS TIMESTAMP)) = s.sec_bucket
CROSS JOIN thres t
WHERE i.""Destination Port"" IN (80, 443)
AND s.flow_count >= t.fc_q99
AND s.avg_fps >= t.fps_q90;",,
"A DoS Hulk attack is an HTTP-based denial-of-service attack generated by the “HULK” tool, which overwhelms a web server by sending a massive number of HTTP GET requests while constantly randomizing elements like the URL query string, User-Agent, and referrer to evade caching and simple filtering. Instead of relying on huge bandwidth alone, it tries to keep the server busy processing each unique-looking request so it can’t handle real users. Common signs of a Hulk-style attack include a sudden, very large spike in HTTP requests to ports 80/443 from one or a small cluster of IPs, logs full of requests to the same path with endlessly changing query parameters, randomized or nonsense User-Agent and referrer headers, rapidly increasing server CPU and memory usage, a high number of concurrent connections in “processing” states, and users experiencing slow responses or frequent 5xx errors (like 503 Service Unavailable) even though the underlying network links may not appear saturated. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS Hulk attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DoS Hulk,"  231,073 ",3117165,Label,ChatGPT5 (Auto),2,"WITH src_stats AS (
SELECT
""Source IP"",
""Destination Port"",
COUNT(*) AS flow_count,
AVG(""Flow Packets/s"") AS avg_fps,
AVG(""Flow Bytes/s"") AS avg_bps
FROM ids2017
WHERE ""Destination Port"" IN (80, 443)
GROUP BY ""Source IP"", ""Destination Port""
),
thres AS (
SELECT
quantile_cont(flow_count, 0.99) AS fc_q99,
quantile_cont(avg_fps, 0.95) AS fps_q95
FROM src_stats
)
SELECT *
FROM ids2017
WHERE ""Destination Port"" IN (80, 443)
AND ""Source IP"" IN (
SELECT s.""Source IP""
FROM src_stats s, thres t
WHERE s.flow_count >= t.fc_q99
AND s.avg_fps >= t.fps_q95
);",,
"A DoS Hulk attack is an HTTP-based denial-of-service attack generated by the “HULK” tool, which overwhelms a web server by sending a massive number of HTTP GET requests while constantly randomizing elements like the URL query string, User-Agent, and referrer to evade caching and simple filtering. Instead of relying on huge bandwidth alone, it tries to keep the server busy processing each unique-looking request so it can’t handle real users. Common signs of a Hulk-style attack include a sudden, very large spike in HTTP requests to ports 80/443 from one or a small cluster of IPs, logs full of requests to the same path with endlessly changing query parameters, randomized or nonsense User-Agent and referrer headers, rapidly increasing server CPU and memory usage, a high number of concurrent connections in “processing” states, and users experiencing slow responses or frequent 5xx errors (like 503 Service Unavailable) even though the underlying network links may not appear saturated. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS Hulk attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DoS Hulk,"  231,073 ",3117165,Label,ChatGPT5 (Auto),3,"WITH dest_burst AS (
SELECT
""Destination IP"",
""Destination Port"",
date_trunc('minute', CAST(""Timestamp"" AS TIMESTAMP)) AS minute_bucket,
COUNT() AS flow_count,
COUNT(DISTINCT ""Source IP"") AS src_cnt,
AVG(""Flow Packets/s"") AS avg_fps
FROM ids2017
WHERE ""Destination Port"" IN (80, 443)
GROUP BY ""Destination IP"", ""Destination Port"", minute_bucket
),
thres AS (
SELECT
quantile_cont(flow_count, 0.99) AS fc_q99,
quantile_cont(avg_fps, 0.90) AS fps_q90
FROM dest_burst
)
SELECT i.
FROM ids2017 i
JOIN dest_burst d
ON i.""Destination IP"" = d.""Destination IP""
AND i.""Destination Port"" = d.""Destination Port""
AND date_trunc('minute', CAST(i.""Timestamp"" AS TIMESTAMP)) = d.minute_bucket
CROSS JOIN thres t
WHERE i.""Destination Port"" IN (80, 443)
AND d.flow_count >= t.fc_q99
AND d.avg_fps >= t.fps_q90
AND d.src_cnt <= 5;",,
"A DoS Hulk attack is an HTTP-based denial-of-service attack generated by the “HULK” tool, which overwhelms a web server by sending a massive number of HTTP GET requests while constantly randomizing elements like the URL query string, User-Agent, and referrer to evade caching and simple filtering. Instead of relying on huge bandwidth alone, it tries to keep the server busy processing each unique-looking request so it can’t handle real users. Common signs of a Hulk-style attack include a sudden, very large spike in HTTP requests to ports 80/443 from one or a small cluster of IPs, logs full of requests to the same path with endlessly changing query parameters, randomized or nonsense User-Agent and referrer headers, rapidly increasing server CPU and memory usage, a high number of concurrent connections in “processing” states, and users experiencing slow responses or frequent 5xx errors (like 503 Service Unavailable) even though the underlying network links may not appear saturated. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS Hulk attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE ids2017 (""Flow ID"" VARCHAR, ""Source IP"" VARCHAR, ""Source Port"" BIGINT, ""Destination IP"" VARCHAR, ""Destination Port"" BIGINT, Protocol BIGINT, Timestamp VARCHAR, ""Flow Duration"" BIGINT, ""Total Fwd Packets"" BIGINT, ""Total Backward Packets"" BIGINT, ""Total Length of Fwd Packets"" BIGINT, ""Total Length of Bwd Packets"" BIGINT, ""Fwd Packet Length Max"" BIGINT, ""Fwd Packet Length Min"" BIGINT, ""Fwd Packet Length Mean"" DOUBLE, ""Fwd Packet Length Std"" DOUBLE, ""Bwd Packet Length Max"" BIGINT, ""Bwd Packet Length Min"" BIGINT, ""Bwd Packet Length Mean"" DOUBLE, ""Bwd Packet Length Std"" DOUBLE, ""Flow Bytes/s"" DOUBLE, ""Flow Packets/s"" DOUBLE, ""Flow IAT Mean"" DOUBLE, ""Flow IAT Std"" DOUBLE, ""Flow IAT Max"" BIGINT, ""Flow IAT Min"" BIGINT, ""Fwd IAT Total"" BIGINT, ""Fwd IAT Mean"" DOUBLE, ""Fwd IAT Std"" DOUBLE, ""Fwd IAT Max"" BIGINT, ""Fwd IAT Min"" BIGINT, ""Bwd IAT Total"" BIGINT, ""Bwd IAT Mean"" DOUBLE, ""Bwd IAT Std"" DOUBLE, ""Bwd IAT Max"" BIGINT, ""Bwd IAT Min"" BIGINT, ""Fwd PSH Flags"" BIGINT, ""Bwd PSH Flags"" BIGINT, ""Fwd URG Flags"" BIGINT, ""Bwd URG Flags"" BIGINT, ""Fwd Header Length"" BIGINT, ""Bwd Header Length"" BIGINT, ""Fwd Packets/s"" DOUBLE, ""Bwd Packets/s"" DOUBLE, ""Min Packet Length"" BIGINT, ""Max Packet Length"" BIGINT, ""Packet Length Mean"" DOUBLE, ""Packet Length Std"" DOUBLE, ""Packet Length Variance"" DOUBLE, ""FIN Flag Count"" BIGINT, ""SYN Flag Count"" BIGINT, ""RST Flag Count"" BIGINT, ""PSH Flag Count"" BIGINT, ""ACK Flag Count"" BIGINT, ""URG Flag Count"" BIGINT, ""CWE Flag Count"" BIGINT, ""ECE Flag Count"" BIGINT, ""Down/Up Ratio"" BIGINT, ""Average Packet"" Size DOUBLE, ""Avg Fwd Segment Size"" DOUBLE, ""Avg Bwd Segment Size"" DOUBLE, ""Fwd Header Length_1"" BIGINT, ""Fwd Avg Bytes/Bulk"" BIGINT, ""Fwd Avg Packets/Bulk"" BIGINT, ""Fwd Avg Bulk Rate"" BIGINT, ""Bwd Avg Bytes/Bulk"" BIGINT, ""Bwd Avg Packets/Bulk"" BIGINT, ""Bwd Avg Bulk Rate"" BIGINT, ""Subflow Fwd Packets"" BIGINT, ""Subflow Fwd Bytes"" BIGINT, ""Subflow Bwd Packets"" BIGINT, ""Subflow Bwd Bytes"" BIGINT, Init_Win_bytes_forward BIGINT, Init_Win_bytes_backward BIGINT, act_data_pkt_fwd BIGINT, min_seg_size_forward BIGINT, ""Active Mean"" DOUBLE, ""Active Std"" DOUBLE, ""Active Max"" BIGINT, ""Active Min"" BIGINT, ""Idle Mean"" DOUBLE, ""Idle Std"" DOUBLE, ""Idle Max"" BIGINT, ""Idle Min"" BIGINT)",DoS Hulk,"  231,073 ",3117165,Label,ChatGPT5 (Auto),4,"WITH candidates AS (
SELECT
""Source IP"",
""Destination IP"",
""Destination Port"",
COUNT() AS flow_count
FROM ids2017
WHERE ""Destination Port"" IN (80, 443)
AND ""Flow Duration"" <= (
SELECT quantile_cont(""Flow Duration"", 0.50)
FROM ids2017
WHERE ""Destination Port"" IN (80, 443)
)
AND ""Flow Packets/s"" >= (
SELECT quantile_cont(""Flow Packets/s"", 0.95)
FROM ids2017
WHERE ""Destination Port"" IN (80, 443)
)
GROUP BY ""Source IP"", ""Destination IP"", ""Destination Port""
HAVING flow_count >= 50
)
SELECT i.
FROM ids2017 i
JOIN candidates c
ON i.""Source IP"" = c.""Source IP""
AND i.""Destination IP"" = c.""Destination IP""
AND i.""Destination Port"" = c.""Destination Port""
WHERE i.""Destination Port"" IN (80, 443);",,
"A fuzzer attack, or fuzzing, is a technique used to discover vulnerabilities in software. It involves sending unexpected or random input data to an application to see how it responds. Overwhelming the application with varied inputs can identify weaknesses or flaws. Fuzzing is an automated process using specialized tools called fuzzers. When a vulnerability is found, attackers can further analyze it and potentially exploit it. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Fuzzers attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT, attack_cat VARCHAR, label BIGINT)",Fuzzers,20499,2280090,attack_cat,ChatGPT5 (Auto),1,"SELECT * FROM unsw_nb15 t
WHERE (
SELECT COUNT(DISTINCT t2.dsport)
FROM unsw_nb15 t2
WHERE t2.srcip = t.srcip
AND FLOOR(t2.Stime / 60) = FLOOR(t.Stime / 60)
) >= 20
AND t.Spkts > 0
AND t.Dpkts >= 0;",,
"A fuzzer attack, or fuzzing, is a technique used to discover vulnerabilities in software. It involves sending unexpected or random input data to an application to see how it responds. Overwhelming the application with varied inputs can identify weaknesses or flaws. Fuzzing is an automated process using specialized tools called fuzzers. When a vulnerability is found, attackers can further analyze it and potentially exploit it. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Fuzzers attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Fuzzers,20499,2280090,attack_cat,ChatGPT5 (Auto),2,"SELECT * FROM unsw_nb15
WHERE (ct_dst_sport_ltm >= 100 OR ct_dst_src_ltm >= 200 OR ct_src_dport_ltm >= 150)
AND smeansz < 80 AND dmeansz < 80
AND (Spkts >= 20 OR Dpkts >= 20);",,
"A fuzzer attack, or fuzzing, is a technique used to discover vulnerabilities in software. It involves sending unexpected or random input data to an application to see how it responds. Overwhelming the application with varied inputs can identify weaknesses or flaws. Fuzzing is an automated process using specialized tools called fuzzers. When a vulnerability is found, attackers can further analyze it and potentially exploit it. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Fuzzers attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Fuzzers,20499,2280090,attack_cat,ChatGPT5 (Auto),3,"SELECT * FROM unsw_nb15
WHERE (service ILIKE 'http%' OR proto ILIKE 'http')
AND ct_flw_http_mthd >= 5
AND res_bdy_len = 0
AND dbytes < 300
AND Spkts > 5;",,
"A fuzzer attack, or fuzzing, is a technique used to discover vulnerabilities in software. It involves sending unexpected or random input data to an application to see how it responds. Overwhelming the application with varied inputs can identify weaknesses or flaws. Fuzzing is an automated process using specialized tools called fuzzers. When a vulnerability is found, attackers can further analyze it and potentially exploit it. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Fuzzers attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Fuzzers,20499,2280090,attack_cat,ChatGPT5 (Auto),4,"SELECT * FROM unsw_nb15 t
WHERE state IN ('REJ','RSTO','RSTR','S0','SH','OTH')
AND dur < 2 AND sbytes < 200 AND dbytes < 200
AND (
SELECT COUNT(*)
FROM unsw_nb15 t2
WHERE t2.srcip = t.srcip
AND t2.dstip = t.dstip
AND t2.dsport = t.dsport
AND ABS(t2.Stime - t.Stime) <= 60
) >= 30;",,
"This attack, also known as information gathering or footprinting, is a cyber attack that focuses on gathering valuable intelligence and information about a target system or network. The main objective of a reconnaissance attack is to gain a deeper understanding of the target's infrastructure, vulnerabilities, and potential entry points without directly causing any damage. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Reconnaissance attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Reconnaissance,11935,2280090,attack_cat,ChatGPT5 (Auto),1,"SELECT * FROM unsw_nb15 t
WHERE (
SELECT COUNT(DISTINCT t2.dsport)
FROM unsw_nb15 t2
WHERE t2.srcip = t.srcip
AND t2.dstip = t.dstip
AND ABS(t2.Stime - t.Stime) <= 60
) >= 30
AND sbytes < 500 AND dbytes < 500
AND Spkts <= 10 AND Dpkts <= 10
AND dur < 2;",,
"This attack, also known as information gathering or footprinting, is a cyber attack that focuses on gathering valuable intelligence and information about a target system or network. The main objective of a reconnaissance attack is to gain a deeper understanding of the target's infrastructure, vulnerabilities, and potential entry points without directly causing any damage. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Reconnaissance attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Reconnaissance,11935,2280090,attack_cat,ChatGPT5 (Auto),2,"SELECT * FROM unsw_nb15 t
WHERE (
SELECT COUNT(DISTINCT t2.dstip)
FROM unsw_nb15 t2
WHERE t2.srcip = t.srcip
AND t2.dsport = t.dsport
AND ABS(t2.Stime - t.Stime) <= 300
) >= 30
AND state IN ('S0','REJ','RSTO','RSTR','SH','OTH')
AND dur < 2;",,
"This attack, also known as information gathering or footprinting, is a cyber attack that focuses on gathering valuable intelligence and information about a target system or network. The main objective of a reconnaissance attack is to gain a deeper understanding of the target's infrastructure, vulnerabilities, and potential entry points without directly causing any damage. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Reconnaissance attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Reconnaissance,11935,2280090,attack_cat,ChatGPT5 (Auto),3,"SELECT * FROM unsw_nb15
WHERE (ct_dst_sport_ltm >= 200 OR ct_src_dport_ltm >= 200 OR ct_dst_src_ltm >= 300 OR ct_srv_dst >= 100)
AND Spkts <= 5 AND Dpkts <= 5
AND sbytes < 400 AND dbytes < 400
AND dur < 1.5;",,
"This attack, also known as information gathering or footprinting, is a cyber attack that focuses on gathering valuable intelligence and information about a target system or network. The main objective of a reconnaissance attack is to gain a deeper understanding of the target's infrastructure, vulnerabilities, and potential entry points without directly causing any damage. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Reconnaissance attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Reconnaissance,11935,2280090,attack_cat,ChatGPT5 (Auto),4,"SELECT * FROM unsw_nb15
WHERE (service ILIKE 'http%' OR service ILIKE 'ftp%')
AND ct_flw_http_mthd >= 4
AND res_bdy_len = 0
AND dbytes < 500 AND sbytes < 1000
AND state IN ('S0','REJ','RSTO','RSTR','SH','OTH');",,
"The term shellcode refers to a small piece of code that is injected into a vulnerable program, typically to gain unauthorized access and control over the system. The attacker first identifies a vulnerability in the target software, such as a buffer overflow or a code injection flaw. They then craft a payload, usually written in assembly language or machine code and designed to perform specific actions once executed. This payload is the shellcode. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Shellcode attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Shellcode,1289,2280090,attack_cat,ChatGPT5 (Auto),1,"SELECT * FROM unsw_nb15
WHERE (service ILIKE 'http%' OR service ILIKE 'ftp%' OR service ILIKE 'smtp%' OR service ILIKE 'ssh%')
AND Spkts BETWEEN 2 AND 8
AND Dpkts <= 3
AND sbytes >= 800
AND dbytes <= 300
AND res_bdy_len = 0
AND dur <= 3;",,
"The term shellcode refers to a small piece of code that is injected into a vulnerable program, typically to gain unauthorized access and control over the system. The attacker first identifies a vulnerability in the target software, such as a buffer overflow or a code injection flaw. They then craft a payload, usually written in assembly language or machine code and designed to perform specific actions once executed. This payload is the shellcode. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Shellcode attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Shellcode,1289,2280090,attack_cat,ChatGPT5 (Auto),2,"SELECT * FROM unsw_nb15 t
WHERE (
SELECT COUNT(*)
FROM unsw_nb15 t2
WHERE t2.srcip = t.srcip
AND t2.dstip = t.dstip
AND t2.dsport = t.dsport
AND ABS(t2.Stime - t.Stime) <= 120
AND t2.sbytes >= 600
AND t2.Dpkts <= 2
) >= 10
AND Spkts <= 5
AND Dpkts <= 2
AND state IN ('S0','REJ','RSTO','RSTR','S1');",,
"The term shellcode refers to a small piece of code that is injected into a vulnerable program, typically to gain unauthorized access and control over the system. The attacker first identifies a vulnerability in the target software, such as a buffer overflow or a code injection flaw. They then craft a payload, usually written in assembly language or machine code and designed to perform specific actions once executed. This payload is the shellcode. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Shellcode attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Shellcode,1289,2280090,attack_cat,ChatGPT5 (Auto),3,"SELECT * FROM unsw_nb15
WHERE proto ILIKE 'tcp'
AND state IN ('RSTO','RSTR')
AND dur < 1.5
AND (swin = 0 OR dwin = 0)
AND Spkts <= 4
AND Dpkts <= 4
AND sbytes >= 400
AND dbytes <= 200;",,
"The term shellcode refers to a small piece of code that is injected into a vulnerable program, typically to gain unauthorized access and control over the system. The attacker first identifies a vulnerability in the target software, such as a buffer overflow or a code injection flaw. They then craft a payload, usually written in assembly language or machine code and designed to perform specific actions once executed. This payload is the shellcode. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Shellcode attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Shellcode,1289,2280090,attack_cat,ChatGPT5 (Auto),4,"SELECT * FROM unsw_nb15
WHERE (ct_dst_sport_ltm >= 50 OR ct_src_dport_ltm >= 50)
AND smeansz >= 700
AND Dpkts <= 2
AND (tcprtt IS NOT NULL AND tcprtt < 0.05)
AND (synack IS NOT NULL AND synack < 0.05)
AND res_bdy_len = 0;",,
"This attack is a method where attackers gather and study information to exploit vulnerabilities in a system. This attack involves techniques such as traffic analysis, cryptographic analysis, code analysis, data analysis, and protocol analysis. Attackers use these techniques to gain insights, extract sensitive data, or identify weaknesses that can be exploited for malicious purposes. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Analysis attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Analysis,2474,2280090,attack_cat,ChatGPT5 (Auto),1,"SELECT * FROM unsw_nb15
WHERE dur >= 600
AND Spkts <= 5 AND Dpkts <= 5
AND (Sload IS NOT NULL AND Sload <= 0.001)
AND (Dload IS NOT NULL AND Dload <= 0.001)
AND res_bdy_len = 0
AND sbytes < 200 AND dbytes < 200;",,
"This attack is a method where attackers gather and study information to exploit vulnerabilities in a system. This attack involves techniques such as traffic analysis, cryptographic analysis, code analysis, data analysis, and protocol analysis. Attackers use these techniques to gain insights, extract sensitive data, or identify weaknesses that can be exploited for malicious purposes. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Analysis attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Analysis,2474,2280090,attack_cat,ChatGPT5 (Auto),2,"SELECT * FROM unsw_nb15 t
WHERE (
SELECT COUNT(DISTINCT COALESCE(NULLIF(t2.service, ''), t2.proto))
FROM unsw_nb15 t2
WHERE t2.srcip = t.srcip
AND FLOOR(t2.Stime / 600) = FLOOR(t.Stime / 600)
) >= 8
AND sbytes < 1000 AND dbytes < 1000
AND Spkts <= 12 AND Dpkts <= 12;",,
"This attack is a method where attackers gather and study information to exploit vulnerabilities in a system. This attack involves techniques such as traffic analysis, cryptographic analysis, code analysis, data analysis, and protocol analysis. Attackers use these techniques to gain insights, extract sensitive data, or identify weaknesses that can be exploited for malicious purposes. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Analysis attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Analysis,2474,2280090,attack_cat,ChatGPT5 (Auto),3,"SELECT * FROM unsw_nb15 t
WHERE (service ILIKE 'ssl%' OR service ILIKE 'https%' OR proto ILIKE 'tls%' OR proto ILIKE 'ssl%')
AND state IN ('S0','REJ','RSTO','RSTR','SH','OTH')
AND dur < 1.5
AND sbytes < 400 AND dbytes < 400
AND (
SELECT COUNT(*)
FROM unsw_nb15 t2
WHERE t2.srcip = t.srcip
AND t2.dstip = t.dstip
AND t2.dsport = t.dsport
AND ABS(t2.Stime - t.Stime) <= 120
) >= 15;",,
"This attack is a method where attackers gather and study information to exploit vulnerabilities in a system. This attack involves techniques such as traffic analysis, cryptographic analysis, code analysis, data analysis, and protocol analysis. Attackers use these techniques to gain insights, extract sensitive data, or identify weaknesses that can be exploited for malicious purposes. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Analysis attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Analysis,2474,2280090,attack_cat,ChatGPT5 (Auto),4,"SELECT * FROM unsw_nb15
WHERE Sintpkt BETWEEN 0.01 AND 0.20
AND Dintpkt BETWEEN 0.01 AND 0.20
AND (Sjit IS NOT NULL AND Sjit < 0.005)
AND (Djit IS NOT NULL AND Djit < 0.005)
AND sbytes < 800 AND dbytes < 800
AND (ct_srv_dst >= 200 OR ct_dst_src_ltm >= 300 OR ct_state_ttl >= 50);",,
"A backdoor attack is a cybersecurity threat where unauthorized access is gained to a computer system or network by exploiting hidden vulnerabilities or intentionally creating openings. It involves the insertion of malicious code or modifications to existing code within a system, allowing attackers to bypass standard security measures and gain control over the targeted system to perform various malicious activities, such as stealing sensitive data, installing additional malware, or launching further attacks on the system or network. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Backdoor attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)
",Backdoor,2236,2280090,attack_cat,ChatGPT5 (Auto),1,"SELECT * FROM unsw_nb15 t
WHERE (
SELECT COUNT(*)
FROM unsw_nb15 t2
WHERE t2.srcip = t.srcip
AND t2.dstip = t.dstip
AND ABS(t2.Stime - t.Stime) <= 900
AND t2.Spkts <= 6 AND t2.Dpkts <= 6
AND t2.sbytes < 800 AND t2.dbytes < 800
) >= 8
AND COALESCE(Sjit, 0) < 0.01 AND COALESCE(Djit, 0) < 0.01
AND COALESCE(Sintpkt, 0) BETWEEN 5 AND 120
AND COALESCE(Dintpkt, 0) BETWEEN 5 AND 120;",,
"A backdoor attack is a cybersecurity threat where unauthorized access is gained to a computer system or network by exploiting hidden vulnerabilities or intentionally creating openings. It involves the insertion of malicious code or modifications to existing code within a system, allowing attackers to bypass standard security measures and gain control over the targeted system to perform various malicious activities, such as stealing sensitive data, installing additional malware, or launching further attacks on the system or network. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Backdoor attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Backdoor,2236,2280090,attack_cat,ChatGPT5 (Auto),2,"SELECT * FROM unsw_nb15
WHERE proto ILIKE 'tcp'
AND state IN ('S1','S2','S3')
AND COALESCE(TRY_CAST(dsport AS INTEGER), 0) >= 49152
AND (NULLIF(service, '') IS NULL OR service ILIKE 'unknown%' OR service ILIKE 'ssl%')
AND Spkts BETWEEN 2 AND 12 AND Dpkts BETWEEN 2 AND 12
AND sbytes < 1500 AND dbytes < 1500
AND (ct_dst_sport_ltm >= 50 OR ct_src_dport_ltm >= 50);",,
"A backdoor attack is a cybersecurity threat where unauthorized access is gained to a computer system or network by exploiting hidden vulnerabilities or intentionally creating openings. It involves the insertion of malicious code or modifications to existing code within a system, allowing attackers to bypass standard security measures and gain control over the targeted system to perform various malicious activities, such as stealing sensitive data, installing additional malware, or launching further attacks on the system or network. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Backdoor attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Backdoor,2236,2280090,attack_cat,ChatGPT5 (Auto),3,"SELECT * FROM unsw_nb15
WHERE dur >= 1800
AND COALESCE(Sload, 0) <= 0.01 AND COALESCE(Dload, 0) <= 0.01
AND Spkts <= 50 AND Dpkts <= 50
AND res_bdy_len = 0
AND sbytes < 50000 AND dbytes < 50000;",,
"A backdoor attack is a cybersecurity threat where unauthorized access is gained to a computer system or network by exploiting hidden vulnerabilities or intentionally creating openings. It involves the insertion of malicious code or modifications to existing code within a system, allowing attackers to bypass standard security measures and gain control over the targeted system to perform various malicious activities, such as stealing sensitive data, installing additional malware, or launching further attacks on the system or network. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Backdoor attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Backdoor,2236,2280090,attack_cat,ChatGPT5 (Auto),4,"SELECT * FROM unsw_nb15 t
WHERE (
SELECT COUNT(*)
FROM unsw_nb15 t2
WHERE t2.srcip = t.srcip
AND t2.dstip = t.dstip
AND t2.dsport = t.dsport
AND t2.state = 'S1'
) >= 30
AND (ct_dst_src_ltm >= 200 OR ct_state_ttl >= 50)
AND Spkts <= 20 AND Dpkts <= 20
AND COALESCE(TRY_CAST(dsport AS INTEGER), 0) NOT IN (80, 443, 53, 22, 25, 110, 143);",,
"A DoS (Denial of Service) attack is when an attacker tries to make a system, website, or network service unavailable to legitimate users by overwhelming it with traffic or resource-consuming requests, so it can’t respond properly anymore. Instead of sneaking in, the attacker’s goal is to disrupt availability—by exhausting bandwidth, CPU, memory, or connection slots. Common signs of a DoS attack include sudden and sustained spikes in traffic, services becoming very slow or completely unresponsive, unusually high numbers of connections or requests from one IP or a small set of IPs, error messages like “service unavailable” or timeouts for normal users, and network or system monitoring tools showing resource exhaustion (maxed-out CPU, bandwidth, or connection tables) without a legitimate reason such as a planned marketing event or expected traffic surge. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",DoS,15618,2280090,attack_cat,ChatGPT5 (Auto),1,"SELECT * FROM unsw_nb15 t
WHERE (
SELECT COUNT(*)
FROM unsw_nb15 t2
WHERE t2.srcip = t.srcip
AND t2.dstip = t.dstip
AND FLOOR(t2.Stime / 60) = FLOOR(t.Stime / 60)
) >= 100
AND state IN ('S0','REJ','RSTO','RSTR')
AND Dpkts <= 3
AND dbytes < 1000;",,
"A DoS (Denial of Service) attack is when an attacker tries to make a system, website, or network service unavailable to legitimate users by overwhelming it with traffic or resource-consuming requests, so it can’t respond properly anymore. Instead of sneaking in, the attacker’s goal is to disrupt availability—by exhausting bandwidth, CPU, memory, or connection slots. Common signs of a DoS attack include sudden and sustained spikes in traffic, services becoming very slow or completely unresponsive, unusually high numbers of connections or requests from one IP or a small set of IPs, error messages like “service unavailable” or timeouts for normal users, and network or system monitoring tools showing resource exhaustion (maxed-out CPU, bandwidth, or connection tables) without a legitimate reason such as a planned marketing event or expected traffic surge. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",DoS,15618,2280090,attack_cat,ChatGPT5 (Auto),2,"SELECT * FROM unsw_nb15 t
WHERE (
SELECT COUNT(DISTINCT t2.srcip)
FROM unsw_nb15 t2
WHERE t2.dstip = t.dstip
AND t2.dsport = t.dsport
AND FLOOR(t2.Stime / 60) = FLOOR(t.Stime / 60)
) >= 50
AND state IN ('S0','REJ','RSTO','RSTR')
AND dbytes < 1000;",,
"A DoS (Denial of Service) attack is when an attacker tries to make a system, website, or network service unavailable to legitimate users by overwhelming it with traffic or resource-consuming requests, so it can’t respond properly anymore. Instead of sneaking in, the attacker’s goal is to disrupt availability—by exhausting bandwidth, CPU, memory, or connection slots. Common signs of a DoS attack include sudden and sustained spikes in traffic, services becoming very slow or completely unresponsive, unusually high numbers of connections or requests from one IP or a small set of IPs, error messages like “service unavailable” or timeouts for normal users, and network or system monitoring tools showing resource exhaustion (maxed-out CPU, bandwidth, or connection tables) without a legitimate reason such as a planned marketing event or expected traffic surge. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",DoS,15618,2280090,attack_cat,ChatGPT5 (Auto),3,"SELECT * FROM unsw_nb15
WHERE proto ILIKE 'tcp'
AND state = 'S0'
AND Spkts <= 3
AND Dpkts = 0
AND dbytes = 0
AND (ct_state_ttl >= 50 OR ct_dst_src_ltm >= 200);",,
"A DoS (Denial of Service) attack is when an attacker tries to make a system, website, or network service unavailable to legitimate users by overwhelming it with traffic or resource-consuming requests, so it can’t respond properly anymore. Instead of sneaking in, the attacker’s goal is to disrupt availability—by exhausting bandwidth, CPU, memory, or connection slots. Common signs of a DoS attack include sudden and sustained spikes in traffic, services becoming very slow or completely unresponsive, unusually high numbers of connections or requests from one IP or a small set of IPs, error messages like “service unavailable” or timeouts for normal users, and network or system monitoring tools showing resource exhaustion (maxed-out CPU, bandwidth, or connection tables) without a legitimate reason such as a planned marketing event or expected traffic surge. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DoS attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",DoS,15618,2280090,attack_cat,ChatGPT5 (Auto),4,"SELECT * FROM unsw_nb15 t
WHERE (service ILIKE 'http%' OR dsport IN ('80','8080','443'))
AND res_bdy_len = 0
AND dbytes < 500
AND Spkts >= 20
AND Dpkts <= 5
AND (
SELECT COUNT(*)
FROM unsw_nb15 t2
WHERE t2.srcip = t.srcip
AND t2.dstip = t.dstip
AND FLOOR(t2.Stime / 60) = FLOOR(t.Stime / 60)
) >= 60;",,
"An exploit attack refers to exploiting computer systems or software vulnerabilities to gain unauthorized access or perform malicious activities. Exploits take advantage of weaknesses or flaws in a system's design or implementation, allowing attackers to execute specific commands or actions not intended by the system's developers. These vulnerabilities can exist in various components, such as operating systems, applications, or network protocols. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Exploit attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Exploits,39390,2280090,attack_cat,ChatGPT5 (Auto),1,"SELECT * FROM unsw_nb15
WHERE (service ILIKE 'http%' OR dsport IN ('80','8080'))
AND ct_flw_http_mthd >= 5
AND res_bdy_len > 8000
AND sbytes < 1500
AND Dpkts >= 2 * GREATEST(1, Spkts);",,
"An exploit attack refers to exploiting computer systems or software vulnerabilities to gain unauthorized access or perform malicious activities. Exploits take advantage of weaknesses or flaws in a system's design or implementation, allowing attackers to execute specific commands or actions not intended by the system's developers. These vulnerabilities can exist in various components, such as operating systems, applications, or network protocols. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Exploit attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Exploits,39390,2280090,attack_cat,ChatGPT5 (Auto),2,"SELECT * FROM unsw_nb15
WHERE service ILIKE 'ftp%'
AND is_ftp_login = 1
AND (ct_ftp_cmd ILIKE 'SITE%' OR ct_ftp_cmd ILIKE 'CWD%' OR ct_ftp_cmd ILIKE 'MKD%' OR ct_ftp_cmd ILIKE 'DELE%' OR ct_ftp_cmd ILIKE 'RNFR%' OR ct_ftp_cmd ILIKE 'RMD%')
AND (ct_srv_dst >= 50 OR ct_dst_src_ltm >= 100)
AND dbytes >= 5 * GREATEST(1, sbytes);",,
"An exploit attack refers to exploiting computer systems or software vulnerabilities to gain unauthorized access or perform malicious activities. Exploits take advantage of weaknesses or flaws in a system's design or implementation, allowing attackers to execute specific commands or actions not intended by the system's developers. These vulnerabilities can exist in various components, such as operating systems, applications, or network protocols. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Exploit attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Exploits,39390,2280090,attack_cat,ChatGPT5 (Auto),3,"SELECT * FROM unsw_nb15 t
WHERE state IN ('S1','SF')
AND dbytes > 0
AND res_bdy_len >= 0
AND (
SELECT COUNT(*)
FROM unsw_nb15 t2
WHERE t2.srcip = t.srcip
AND t2.dstip = t.dstip
AND t2.dsport = t.dsport
AND t2.state IN ('S0','REJ','RSTO','RSTR','SH','OTH')
AND t2.Stime BETWEEN t.Stime - 300 AND t.Stime
) >= 10;",,
"An exploit attack refers to exploiting computer systems or software vulnerabilities to gain unauthorized access or perform malicious activities. Exploits take advantage of weaknesses or flaws in a system's design or implementation, allowing attackers to execute specific commands or actions not intended by the system's developers. These vulnerabilities can exist in various components, such as operating systems, applications, or network protocols. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Exploit attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Exploits,39390,2280090,attack_cat,ChatGPT5 (Auto),4,"SELECT * FROM unsw_nb15
WHERE (service ILIKE 'ssl%' OR service ILIKE 'https%' OR proto ILIKE 'tls%' OR proto ILIKE 'ssl%')
AND sbytes BETWEEN 40 AND 120
AND dbytes >= 2000
AND dur < 2
AND res_bdy_len > 0;",,
"It is a kind of attack against the cryptography systems, which can run against all block-ciphers independently of their structure. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Generic attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Generic,159161,2280090,attack_cat,ChatGPT5 (Auto),1,"SELECT * FROM unsw_nb15 t
WHERE (service ILIKE 'ssl%' OR service ILIKE 'https%' OR dsport IN ('443','465','993','995','8443'))
AND dur < 2
AND Spkts <= 6 AND Dpkts <= 6
AND sbytes BETWEEN 40 AND 200
AND dbytes BETWEEN 40 AND 1200
AND res_bdy_len = 0
AND (
SELECT COUNT(*)
FROM unsw_nb15 t2
WHERE t2.srcip = t.srcip
AND t2.dstip = t.dstip
AND t2.dsport = t.dsport
AND ABS(t2.Stime - t.Stime) <= 60
) >= 20;",,
"It is a kind of attack against the cryptography systems, which can run against all block-ciphers independently of their structure. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Generic attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Generic,159161,2280090,attack_cat,ChatGPT5 (Auto),2,"SELECT * FROM unsw_nb15 t
WHERE (service ILIKE 'ssl%' OR service ILIKE 'https%' OR proto ILIKE 'tls%' OR proto ILIKE 'ssl%')
AND sbytes < 500 AND dbytes < 1500
AND Spkts <= 8 AND Dpkts <= 8
AND res_bdy_len = 0
AND (
SELECT COUNT(DISTINCT t2.dstip)
FROM unsw_nb15 t2
WHERE t2.srcip = t.srcip
AND t2.dsport = t.dsport
AND FLOOR(t2.Stime / 300) = FLOOR(t.Stime / 300)
) >= 30;",,
"It is a kind of attack against the cryptography systems, which can run against all block-ciphers independently of their structure. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Generic attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Generic,159161,2280090,attack_cat,ChatGPT5 (Auto),3,"SELECT * FROM unsw_nb15
WHERE (service ILIKE 'ssl%' OR service ILIKE 'https%')
AND state IN ('S0','REJ','RSTO','RSTR','SH','OTH')
AND (ct_state_ttl >= 50 OR ct_dst_src_ltm >= 200 OR ct_srv_dst >= 100)
AND sbytes < 800 AND dbytes < 800
AND Spkts <= 5 AND Dpkts <= 5
AND res_bdy_len = 0;",,
"It is a kind of attack against the cryptography systems, which can run against all block-ciphers independently of their structure. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Generic attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Generic,159161,2280090,attack_cat,ChatGPT5 (Auto),4,"SELECT * FROM unsw_nb15
WHERE proto ILIKE 'tcp'
AND (service ILIKE 'ssl%' OR service ILIKE 'https%')
AND Sintpkt BETWEEN 0.01 AND 0.08
AND Dintpkt BETWEEN 0.01 AND 0.08
AND COALESCE(Sjit,0) < 0.005 AND COALESCE(Djit,0) < 0.005
AND sbytes < 600 AND dbytes < 600
AND (ct_srv_dst >= 150 OR ct_dst_src_ltm >= 200);",,
"This malicious cyber-attack spreads through computer networks, targeting vulnerable systems and exploiting security vulnerabilities. Unlike viruses or Trojans, worms do not require user interaction to propagate. They can independently replicate and spread across a network, infecting multiple computers and devices. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Worms attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Worms,150,2280090,attack_cat,ChatGPT5 (Auto),1,"ChatGPT said:SELECT * FROM unsw_nb15 t
WHERE (
SELECT COUNT(DISTINCT t2.dstip)
FROM unsw_nb15 t2
WHERE t2.srcip = t.srcip
AND FLOOR(t2.Stime / 60) = FLOOR(t.Stime / 60)
) >= 50
AND state IN ('S0','REJ','RSTO','RSTR','SH','OTH')
AND sbytes < 500 AND dbytes < 500;",,
"This malicious cyber-attack spreads through computer networks, targeting vulnerable systems and exploiting security vulnerabilities. Unlike viruses or Trojans, worms do not require user interaction to propagate. They can independently replicate and spread across a network, infecting multiple computers and devices. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Worms attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Worms,150,2280090,attack_cat,ChatGPT5 (Auto),2,"SELECT * FROM unsw_nb15 t
WHERE EXISTS (
SELECT 1
FROM unsw_nb15 a
WHERE a.dstip = t.srcip
AND a.dsport IN ('135','139','445','1433','25')
AND a.Stime BETWEEN t.Stime - 600 AND t.Stime
)
AND (
SELECT COUNT(DISTINCT b.dstip)
FROM unsw_nb15 b
WHERE b.srcip = t.srcip
AND b.Stime BETWEEN t.Stime AND t.Stime + 900
) >= 20
AND Spkts <= 6 AND Dpkts <= 3;",,
"This malicious cyber-attack spreads through computer networks, targeting vulnerable systems and exploiting security vulnerabilities. Unlike viruses or Trojans, worms do not require user interaction to propagate. They can independently replicate and spread across a network, infecting multiple computers and devices. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Worms attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Worms,150,2280090,attack_cat,ChatGPT5 (Auto),3,"SELECT * FROM unsw_nb15
WHERE (ct_src_dport_ltm >= 200 OR ct_srv_dst >= 200)
AND Spkts <= 5 AND Dpkts <= 2
AND sbytes < 400 AND dbytes < 400
AND state IN ('S0','REJ','RSTO','RSTR');",,
"This malicious cyber-attack spreads through computer networks, targeting vulnerable systems and exploiting security vulnerabilities. Unlike viruses or Trojans, worms do not require user interaction to propagate. They can independently replicate and spread across a network, infecting multiple computers and devices. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Worms attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE unsw_nb15 (srcip VARCHAR, sport VARCHAR, dstip VARCHAR, dsport VARCHAR, proto VARCHAR, state VARCHAR, dur DOUBLE, sbytes BIGINT, dbytes BIGINT, sttl BIGINT, dttl BIGINT, sloss BIGINT, dloss BIGINT, service VARCHAR, Sload DOUBLE, Dload DOUBLE, Spkts BIGINT, Dpkts BIGINT, swin BIGINT, dwin BIGINT, stcpb BIGINT, dtcpb BIGINT, smeansz BIGINT, dmeansz BIGINT, trans_depth BIGINT, res_bdy_len BIGINT, Sjit DOUBLE, Djit DOUBLE, Stime BIGINT, Ltime BIGINT, Sintpkt DOUBLE, Dintpkt DOUBLE, tcprtt DOUBLE, synack DOUBLE, ackdat DOUBLE, is_sm_ips_ports BIGINT, ct_state_ttl BIGINT, ct_flw_http_mthd DOUBLE, is_ftp_login DOUBLE, ct_ftp_cmd VARCHAR, ct_srv_src BIGINT, ct_srv_dst BIGINT, ct_dst_ltm BIGINT, ct_src_ltm BIGINT, ct_src_dport_ltm BIGINT, ct_dst_sport_ltm BIGINT, ct_dst_src_ltm BIGINT)",Worms,150,2280090,attack_cat,ChatGPT5 (Auto),4,"SELECT * FROM unsw_nb15
WHERE (ct_dst_src_ltm >= 300 OR ct_state_ttl >= 50)
AND dbytes = 0
AND Dpkts = 0
AND state = 'S0'
AND res_bdy_len = 0;",,
"The Torii botnet is a sophisticated IoT-focused malware family that compromises internet-connected devices (routers, cameras, small Linux boxes, etc.) using methods like Telnet brute-forcing of weak credentials, then runs an architecture-aware install script to drop tailored binaries for many CPU types and establish long-term, stealthy control. Unlike simpler Mirai-style botnets that mostly fire off DDoS floods, Torii emphasizes persistence and data exfiltration: it uses multiple persistence mechanisms, strong obfuscation, and flexible command-and-control, allowing attackers to steal information, run arbitrary commands, and potentially pivot deeper into networks. Common signs that Torii (or a similar advanced IoT botnet) is active include lots of outbound connections from embedded/IoT devices to unusual domains or IPs on non-standard ports, long-lived C2 sessions using HTTP, HTTPS, or custom protocols, devices downloading strange shell scripts or ELF binaries, unexplained spikes in outbound traffic or DNS queries from “dumb” devices, and security tools flagging Mirai-like Telnet brute-force attempts followed by quieter, persistent communication rather than immediate DDoS traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C Torii attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-Torii,30,6046623,label,ChatGPT5 (Auto),1,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1 AND COALESCE(local_resp, 0) = 0
AND (service IS NULL OR service IN ('', '-', 'unknown'))
AND id.resp_p NOT IN (80,443,53,123,22,25,110,143,993,995,587,21,23,445,1433,3306,8080)
AND id.resp_p >= 1024
AND duration >= 600
AND (orig_bytes + resp_bytes) >= 1000;",,
"The Torii botnet is a sophisticated IoT-focused malware family that compromises internet-connected devices (routers, cameras, small Linux boxes, etc.) using methods like Telnet brute-forcing of weak credentials, then runs an architecture-aware install script to drop tailored binaries for many CPU types and establish long-term, stealthy control. Unlike simpler Mirai-style botnets that mostly fire off DDoS floods, Torii emphasizes persistence and data exfiltration: it uses multiple persistence mechanisms, strong obfuscation, and flexible command-and-control, allowing attackers to steal information, run arbitrary commands, and potentially pivot deeper into networks. Common signs that Torii (or a similar advanced IoT botnet) is active include lots of outbound connections from embedded/IoT devices to unusual domains or IPs on non-standard ports, long-lived C2 sessions using HTTP, HTTPS, or custom protocols, devices downloading strange shell scripts or ELF binaries, unexplained spikes in outbound traffic or DNS queries from “dumb” devices, and security tools flagging Mirai-like Telnet brute-force attempts followed by quieter, persistent communication rather than immediate DDoS traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C Torii attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-Torii,30,6046623,label,ChatGPT5 (Auto),2,"SELECT * FROM iot_23
WHERE COALESCE(local_orig, 0) = 1 AND COALESCE(local_resp, 0) = 0
AND (service ILIKE 'http%' OR service ILIKE 'https%')
AND resp_bytes >= 10 * GREATEST(1, orig_bytes)
AND duration BETWEEN 5 AND 900;",,
"The Torii botnet is a sophisticated IoT-focused malware family that compromises internet-connected devices (routers, cameras, small Linux boxes, etc.) using methods like Telnet brute-forcing of weak credentials, then runs an architecture-aware install script to drop tailored binaries for many CPU types and establish long-term, stealthy control. Unlike simpler Mirai-style botnets that mostly fire off DDoS floods, Torii emphasizes persistence and data exfiltration: it uses multiple persistence mechanisms, strong obfuscation, and flexible command-and-control, allowing attackers to steal information, run arbitrary commands, and potentially pivot deeper into networks. Common signs that Torii (or a similar advanced IoT botnet) is active include lots of outbound connections from embedded/IoT devices to unusual domains or IPs on non-standard ports, long-lived C2 sessions using HTTP, HTTPS, or custom protocols, devices downloading strange shell scripts or ELF binaries, unexplained spikes in outbound traffic or DNS queries from “dumb” devices, and security tools flagging Mirai-like Telnet brute-force attempts followed by quieter, persistent communication rather than immediate DDoS traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C Torii attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-Torii,30,6046623,label,ChatGPT5 (Auto),3,"SELECT * FROM iot_23 t
WHERE service ILIKE 'dns'
AND (
SELECT COUNT(*)
FROM iot_23 d
WHERE d.id.orig_h = t.id.orig_h
AND d.service ILIKE 'dns'
AND FLOOR(d.ts / 300) = FLOOR(t.ts / 300)
) >= 200;",,
"The Torii botnet is a sophisticated IoT-focused malware family that compromises internet-connected devices (routers, cameras, small Linux boxes, etc.) using methods like Telnet brute-forcing of weak credentials, then runs an architecture-aware install script to drop tailored binaries for many CPU types and establish long-term, stealthy control. Unlike simpler Mirai-style botnets that mostly fire off DDoS floods, Torii emphasizes persistence and data exfiltration: it uses multiple persistence mechanisms, strong obfuscation, and flexible command-and-control, allowing attackers to steal information, run arbitrary commands, and potentially pivot deeper into networks. Common signs that Torii (or a similar advanced IoT botnet) is active include lots of outbound connections from embedded/IoT devices to unusual domains or IPs on non-standard ports, long-lived C2 sessions using HTTP, HTTPS, or custom protocols, devices downloading strange shell scripts or ELF binaries, unexplained spikes in outbound traffic or DNS queries from “dumb” devices, and security tools flagging Mirai-like Telnet brute-force attempts followed by quieter, persistent communication rather than immediate DDoS traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C Torii attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-Torii,30,6046623,label,ChatGPT5 (Auto),4,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1 AND COALESCE(local_resp, 0) = 0
AND (service IS NULL OR service IN ('', '-', 'unknown'))
AND id.resp_p NOT IN (80,443,53,123,22,25,110,143,993,995,587,21,23,445,1433,3306,8080)
AND duration >= 300
AND EXISTS (
SELECT 1
FROM iot_23 pre
WHERE pre.id.orig_h = t.id.orig_h
AND (pre.service ILIKE 'telnet' OR pre.id.resp_p = 23)
AND pre.ts BETWEEN t.ts - 86400 AND t.ts
AND pre.duration < 5
)
AND (
SELECT COUNT(*)
FROM iot_23 t2
WHERE t2.id.orig_h = t.id.orig_h
AND t2.id.resp_h = t.id.resp_h
AND t2.id.resp_p = t.id.resp_p
AND t2.ts BETWEEN t.ts - 3600 AND t.ts + 3600
) >= 10;",,
"Rows where a DDos (Distributed Denial of Service) attack is being executed by the infected device. These traffic flows are detected as part of a DDoS ​​attack because of the amount of flows directed to the same IP address. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DDoS attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",DDoS,638506,6046623,label,ChatGPT5 (Auto),1,"ChatGPT said:SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND (
SELECT COUNT(*)
FROM iot_23 t2
WHERE t2.""id.orig_h"" = t.""id.orig_h""
AND t2.""id.resp_h"" = t.""id.resp_h""
AND FLOOR(t2.ts / 60) = FLOOR(t.ts / 60)
) >= 100
AND COALESCE(resp_bytes, 0) = 0;",,
"Rows where a DDos (Distributed Denial of Service) attack is being executed by the infected device. These traffic flows are detected as part of a DDoS ​​attack because of the amount of flows directed to the same IP address. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DDoS attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",DDoS,638506,6046623,label,ChatGPT5 (Auto),2,"SELECT * FROM iot_23 t
WHERE proto ILIKE 'tcp'
AND conn_state IN ('S0','REJ')
AND COALESCE(resp_pkts, 0) = 0
AND duration < 2
AND (
SELECT COUNT(*)
FROM iot_23 s
WHERE s.""id.orig_h"" = t.""id.orig_h""
AND s.""id.resp_h"" = t.""id.resp_h""
AND s.proto ILIKE 'tcp'
AND s.conn_state IN ('S0','REJ')
AND s.ts BETWEEN t.ts - 60 AND t.ts + 60
) >= 60;",,
"Rows where a DDos (Distributed Denial of Service) attack is being executed by the infected device. These traffic flows are detected as part of a DDoS ​​attack because of the amount of flows directed to the same IP address. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DDoS attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",DDoS,638506,6046623,label,ChatGPT5 (Auto),3,"SELECT * FROM iot_23 t
WHERE proto ILIKE 'udp'
AND duration < 1
AND COALESCE(resp_pkts, 0) = 0
AND (
SELECT COUNT(*)
FROM iot_23 u
WHERE u.""id.orig_h"" = t.""id.orig_h""
AND u.""id.resp_h"" = t.""id.resp_h""
AND u.proto ILIKE 'udp'
AND FLOOR(u.ts / 30) = FLOOR(t.ts / 30)
) >= 200;",,
"Rows where a DDos (Distributed Denial of Service) attack is being executed by the infected device. These traffic flows are detected as part of a DDoS ​​attack because of the amount of flows directed to the same IP address. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the DDoS attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",DDoS,638506,6046623,label,ChatGPT5 (Auto),4,"SELECT * FROM iot_23 t
WHERE (
SELECT COUNT(DISTINCT d.""id.orig_h"")
FROM iot_23 d
WHERE d.""id.resp_h"" = t.""id.resp_h""
AND FLOOR(d.ts / 60) = FLOOR(t.ts / 60)
) >= 20
AND (
SELECT COUNT(*)
FROM iot_23 o
WHERE o.""id.orig_h"" = t.""id.orig_h""
AND o.""id.resp_h"" = t.""id.resp_h""
AND FLOOR(o.ts / 60) = FLOOR(t.ts / 60)
) >= 10
AND COALESCE(local_orig, 0) = 1;",,
"Filedownload is when a file is being downloaded to our infected device. This is detected by filtering connections with response bytes more than 3KB or 5KB, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the FileDownload attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",FileDownload,13,6046623,label,ChatGPT5 (Auto),1,"SELECT * FROM iot_23
WHERE COALESCE(local_orig, 0) = 1
AND (service ILIKE 'http%' OR service ILIKE 'https%' OR service ILIKE 'ftp%')
AND resp_bytes >= 5000
AND resp_bytes >= 3 * GREATEST(1, orig_bytes);",,
"Filedownload is when a file is being downloaded to our infected device. This is detected by filtering connections with response bytes more than 3KB or 5KB, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the FileDownload attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",FileDownload,13,6046623,label,ChatGPT5 (Auto),2,"SELECT * FROM iot_23
WHERE COALESCE(local_orig, 0) = 1
AND (service IS NULL OR service IN ('', '-', 'unknown'))
AND resp_bytes >= 3000
AND ""id.resp_p"" IN (8081, 4443, 8000, 9001, 1337, 6667, 12345);",,
"Filedownload is when a file is being downloaded to our infected device. This is detected by filtering connections with response bytes more than 3KB or 5KB, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the FileDownload attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",FileDownload,13,6046623,label,ChatGPT5 (Auto),3,"SELECT * FROM iot_23
WHERE COALESCE(local_orig, 0) = 1
AND conn_state IN ('SF','S1')
AND duration >= 10
AND COALESCE(resp_pkts, 0) >= 20
AND resp_bytes >= 5000;",,
"Filedownload is when a file is being downloaded to our infected device. This is detected by filtering connections with response bytes more than 3KB or 5KB, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the FileDownload attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",FileDownload,13,6046623,label,ChatGPT5 (Auto),4,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND resp_bytes >= 3000
AND (
SELECT COUNT(*)
FROM iot_23 x
WHERE x.""id.orig_h"" = t.""id.orig_h""
AND x.""id.resp_h"" = t.""id.resp_h""
AND x.""id.resp_p"" = t.""id.resp_p""
AND x.resp_bytes >= 3000
AND x.ts BETWEEN t.ts - 600 AND t.ts + 600
) >= 3;",,
"An attack means that there was some type of attack from an infected device to another host. These include flows that try to take advantage of some vulnerable service, for example a brute force to some telnet login, a command injection in the header of a GET request, etc. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",Attack,538,6046623,label,ChatGPT5 (Auto),1,"ChatGPT said:SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND ((service ILIKE 'telnet') OR ""id.resp_p"" IN (23, 2323))
AND duration < 2
AND COALESCE(resp_bytes, 0) = 0
AND conn_state IN ('S0','REJ')
AND (
SELECT COUNT(*)
FROM iot_23 x
WHERE x.""id.orig_h"" = t.""id.orig_h""
AND x.""id.resp_h"" = t.""id.resp_h""
AND x.""id.resp_p"" = t.""id.resp_p""
AND x.conn_state IN ('S0','REJ')
AND x.ts BETWEEN t.ts - 120 AND t.ts + 120
) >= 30;",,
"An attack means that there was some type of attack from an infected device to another host. These include flows that try to take advantage of some vulnerable service, for example a brute force to some telnet login, a command injection in the header of a GET request, etc. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",Attack,538,6046623,label,ChatGPT5 (Auto),2,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND (service ILIKE 'http%' OR ""id.resp_p"" IN (80, 8080, 7547))
AND duration < 2
AND orig_bytes >= 5 * GREATEST(1, resp_bytes) + 1000
AND (
SELECT COUNT(*)
FROM iot_23 h
WHERE h.""id.orig_h"" = t.""id.orig_h""
AND h.""id.resp_h"" = t.""id.resp_h""
AND h.""id.resp_p"" = t.""id.resp_p""
AND (h.service ILIKE 'http%' OR h.""id.resp_p"" IN (80, 8080, 7547))
AND h.ts BETWEEN t.ts - 120 AND t.ts + 120
) >= 10;",,
"An attack means that there was some type of attack from an infected device to another host. These include flows that try to take advantage of some vulnerable service, for example a brute force to some telnet login, a command injection in the header of a GET request, etc. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",Attack,538,6046623,label,ChatGPT5 (Auto),3,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND ""id.resp_p"" IN (23, 2323, 80, 8080, 7547, 5555)
AND duration < 1.5
AND orig_bytes <= 600 AND resp_bytes <= 600
AND (
SELECT COUNT(DISTINCT s.""id.resp_h"")
FROM iot_23 s
WHERE s.""id.orig_h"" = t.""id.orig_h""
AND s.""id.resp_p"" = t.""id.resp_p""
AND FLOOR(s.ts / 60) = FLOOR(t.ts / 60)
) >= 30;",,
"An attack means that there was some type of attack from an infected device to another host. These include flows that try to take advantage of some vulnerable service, for example a brute force to some telnet login, a command injection in the header of a GET request, etc. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",Attack,538,6046623,label,ChatGPT5 (Auto),4,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND conn_state IN ('SF','S1')
AND EXISTS (
SELECT 1
FROM iot_23 f
WHERE f.""id.orig_h"" = t.""id.orig_h""
AND f.""id.resp_h"" = t.""id.resp_h""
AND f.""id.resp_p"" = t.""id.resp_p""
AND f.conn_state IN ('S0','REJ','RSTO','RSTR')
AND f.ts BETWEEN t.ts - 600 AND t.ts
HAVING COUNT(*) >= 10
);",,
"This is when a row shows signs of C&C, Heartbeat, and FileDownload
FileDownload: Filedownload is when a file is being downloaded to our infected device. This is detected by filtering connections with response bytes more than 3KB or 5KB, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server.
C&C: C&C (Command & control) means an infected device was connected to a C&C server. This activity was detected in the analysis of the network malware capture because the connections to the suspicious server are periodic or our infected device is downloading some binaries from it or some IRC like or decoded orders are coming and going from it.
Heartbeat: 
Packets sent as a part of a C&C-heartbeat are used to keep a track on the infected host by the C&C server. This was detected by filtering connections with response bytes lower than 1B and with periodic similar connections, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-HeartBeat-FileDownload attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.  
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-HeartBeat-FileDownload,8,6046623,label,ChatGPT5 (Auto),1,"ChatGPT said:SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND COALESCE(resp_bytes, 0) <= 1
AND (
SELECT COUNT(*)
FROM iot_23 hb
WHERE hb.""id.orig_h"" = t.""id.orig_h""
AND hb.""id.resp_h"" = t.""id.resp_h""
AND hb.""id.resp_p"" = t.""id.resp_p""
AND FLOOR(hb.ts / 300) = FLOOR(t.ts / 300)
AND COALESCE(hb.resp_bytes, 0) <= 1
) >= 5
AND EXISTS (
SELECT 1
FROM iot_23 dl
WHERE dl.""id.orig_h"" = t.""id.orig_h""
AND dl.""id.resp_h"" = t.""id.resp_h""
AND dl.""id.resp_p"" = t.""id.resp_p""
AND dl.resp_bytes >= 5000
AND dl.ts BETWEEN t.ts - 86400 AND t.ts + 86400
);",,
"This is when a row shows signs of C&C, Heartbeat, and FileDownload
FileDownload: Filedownload is when a file is being downloaded to our infected device. This is detected by filtering connections with response bytes more than 3KB or 5KB, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server.
C&C: C&C (Command & control) means an infected device was connected to a C&C server. This activity was detected in the analysis of the network malware capture because the connections to the suspicious server are periodic or our infected device is downloading some binaries from it or some IRC like or decoded orders are coming and going from it.
Heartbeat: 
Packets sent as a part of a C&C-heartbeat are used to keep a track on the infected host by the C&C server. This was detected by filtering connections with response bytes lower than 1B and with periodic similar connections, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-HeartBeat-FileDownload attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.  
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-HeartBeat-FileDownload,8,6046623,label,ChatGPT5 (Auto),2,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND resp_bytes >= 3000
AND (service ILIKE 'http%' OR service ILIKE 'https%' OR service ILIKE 'ftp%' OR ""id.resp_p"" IN (8081, 4443, 8000, 9001, 1337, 6667, 12345))
AND (
SELECT COUNT(*)
FROM iot_23 hb
WHERE hb.""id.orig_h"" = t.""id.orig_h""
AND hb.""id.resp_h"" = t.""id.resp_h""
AND hb.""id.resp_p"" = t.""id.resp_p""
AND COALESCE(hb.resp_bytes, 0) <= 1
AND hb.ts BETWEEN t.ts - 3600 AND t.ts + 3600
) >= 10;",,
"This is when a row shows signs of C&C, Heartbeat, and FileDownload
FileDownload: Filedownload is when a file is being downloaded to our infected device. This is detected by filtering connections with response bytes more than 3KB or 5KB, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server.
C&C: C&C (Command & control) means an infected device was connected to a C&C server. This activity was detected in the analysis of the network malware capture because the connections to the suspicious server are periodic or our infected device is downloading some binaries from it or some IRC like or decoded orders are coming and going from it.
Heartbeat: 
Packets sent as a part of a C&C-heartbeat are used to keep a track on the infected host by the C&C server. This was detected by filtering connections with response bytes lower than 1B and with periodic similar connections, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-HeartBeat-FileDownload attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.  
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-HeartBeat-FileDownload,8,6046623,label,ChatGPT5 (Auto),3,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND (service IS NULL OR service IN ('', '-', 'unknown'))
AND duration BETWEEN 30 AND 600
AND COALESCE(resp_bytes, 0) <= 1
AND (
SELECT COUNT(DISTINCT FLOOR(hb.ts / 120))
FROM iot_23 hb
WHERE hb.""id.orig_h"" = t.""id.orig_h""
AND hb.""id.resp_h"" = t.""id.resp_h""
AND hb.""id.resp_p"" = t.""id.resp_p""
AND COALESCE(hb.resp_bytes, 0) <= 1
AND hb.ts BETWEEN t.ts - 7200 AND t.ts + 7200
) >= 8
AND EXISTS (
SELECT 1
FROM iot_23 dl
WHERE dl.""id.orig_h"" = t.""id.orig_h""
AND dl.""id.resp_h"" = t.""id.resp_h""
AND dl.""id.resp_p"" = t.""id.resp_p""
AND dl.resp_bytes >= 5000
AND dl.ts BETWEEN t.ts - 86400 AND t.ts + 86400
);",,
"This is when a row shows signs of C&C, Heartbeat, and FileDownload
FileDownload: Filedownload is when a file is being downloaded to our infected device. This is detected by filtering connections with response bytes more than 3KB or 5KB, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server.
C&C: C&C (Command & control) means an infected device was connected to a C&C server. This activity was detected in the analysis of the network malware capture because the connections to the suspicious server are periodic or our infected device is downloading some binaries from it or some IRC like or decoded orders are coming and going from it.
Heartbeat: 
Packets sent as a part of a C&C-heartbeat are used to keep a track on the infected host by the C&C server. This was detected by filtering connections with response bytes lower than 1B and with periodic similar connections, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server.
Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-HeartBeat-FileDownload attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.  
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-HeartBeat-FileDownload,8,6046623,label,ChatGPT5 (Auto),4,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND EXISTS (
SELECT 1
FROM (
SELECT
COUNT(*) AS total_flows,
SUM(CASE WHEN COALESCE(resp_bytes, 0) <= 1 THEN 1 ELSE 0 END) AS beacon_flows,
SUM(CASE WHEN resp_bytes >= 3000 THEN 1 ELSE 0 END) AS download_flows
FROM iot_23 w
WHERE w.""id.orig_h"" = t.""id.orig_h""
AND w.""id.resp_h"" = t.""id.resp_h""
AND w.""id.resp_p"" = t.""id.resp_p""
AND w.ts BETWEEN t.ts - 43200 AND t.ts + 43200
) agg
WHERE agg.total_flows >= 50 AND agg.beacon_flows >= 40 AND agg.download_flows >= 1
);",,
"The Okiru botnet is a variant of Mirai designed primarily to compromise Internet of Things (IoT) devices—especially those using specific ARC CPU architectures—by exploiting weak/default credentials and known vulnerabilities, then enrolling them into a large distributed network that can be used for powerful DDoS attacks. Once devices are infected, they typically connect out to a command-and-control (C2) server to receive instructions for which targets to flood and what attack methods to use (e.g., TCP/UDP floods). Common signs that Okiru or a similar IoT botnet is active in your environment include lots of outbound connections from cheap/embedded devices (cameras, DVRs, routers) to unusual external IPs or ports, devices initiating connections on ports they don’t normally use, sudden spikes in outbound traffic volume (especially uniform UDP or TCP packets) toward a single target or small set of targets, IDS/IPS alerts tied to Mirai-like signatures, and IoT devices becoming sluggish or unstable because their resources are being consumed by ongoing DDoS traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Okiru attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",Okiru,1313012,6046623,label,ChatGPT5 (Auto),1,"ChatGPT said:SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND ""id.resp_p"" IN (23, 2323)
AND conn_state IN ('S0','REJ')
AND COALESCE(resp_bytes, 0) = 0
AND (
SELECT COUNT(DISTINCT s.""id.resp_h"")
FROM iot_23 s
WHERE s.""id.orig_h"" = t.""id.orig_h""
AND s.""id.resp_p"" IN (23, 2323)
AND s.conn_state IN ('S0','REJ')
AND COALESCE(s.resp_bytes, 0) = 0
AND s.ts BETWEEN t.ts - 300 AND t.ts + 300
) >= 30;",,
"The Okiru botnet is a variant of Mirai designed primarily to compromise Internet of Things (IoT) devices—especially those using specific ARC CPU architectures—by exploiting weak/default credentials and known vulnerabilities, then enrolling them into a large distributed network that can be used for powerful DDoS attacks. Once devices are infected, they typically connect out to a command-and-control (C2) server to receive instructions for which targets to flood and what attack methods to use (e.g., TCP/UDP floods). Common signs that Okiru or a similar IoT botnet is active in your environment include lots of outbound connections from cheap/embedded devices (cameras, DVRs, routers) to unusual external IPs or ports, devices initiating connections on ports they don’t normally use, sudden spikes in outbound traffic volume (especially uniform UDP or TCP packets) toward a single target or small set of targets, IDS/IPS alerts tied to Mirai-like signatures, and IoT devices becoming sluggish or unstable because their resources are being consumed by ongoing DDoS traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Okiru attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",Okiru,1313012,6046623,label,ChatGPT5 (Auto),2,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND proto ILIKE 'udp'
AND duration < 2
AND COALESCE(resp_pkts, 0) = 0
AND (
SELECT COUNT(*)
FROM iot_23 u
WHERE u.""id.orig_h"" = t.""id.orig_h""
AND u.""id.resp_h"" = t.""id.resp_h""
AND u.proto ILIKE 'udp'
AND u.ts BETWEEN t.ts - 60 AND t.ts + 60
) >= 200;",,
"The Okiru botnet is a variant of Mirai designed primarily to compromise Internet of Things (IoT) devices—especially those using specific ARC CPU architectures—by exploiting weak/default credentials and known vulnerabilities, then enrolling them into a large distributed network that can be used for powerful DDoS attacks. Once devices are infected, they typically connect out to a command-and-control (C2) server to receive instructions for which targets to flood and what attack methods to use (e.g., TCP/UDP floods). Common signs that Okiru or a similar IoT botnet is active in your environment include lots of outbound connections from cheap/embedded devices (cameras, DVRs, routers) to unusual external IPs or ports, devices initiating connections on ports they don’t normally use, sudden spikes in outbound traffic volume (especially uniform UDP or TCP packets) toward a single target or small set of targets, IDS/IPS alerts tied to Mirai-like signatures, and IoT devices becoming sluggish or unstable because their resources are being consumed by ongoing DDoS traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Okiru attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",Okiru,1313012,6046623,label,ChatGPT5 (Auto),3,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND (service IS NULL OR service IN ('', '-', 'unknown'))
AND ""id.resp_p"" NOT IN (80,443,53,123,22,25,110,143,993,995,587,21,23,2323,445,1433,3306,8080)
AND ""id.resp_p"" >= 1024
AND COALESCE(resp_bytes, 0) <= 200
AND (
SELECT COUNT(DISTINCT FLOOR(b.ts / 300))
FROM iot_23 b
WHERE b.""id.orig_h"" = t.""id.orig_h""
AND b.""id.resp_h"" = t.""id.resp_h""
AND b.""id.resp_p"" = t.""id.resp_p""
AND COALESCE(b.resp_bytes, 0) <= 200
AND b.ts BETWEEN t.ts - 7200 AND t.ts + 7200
) >= 6;",,
"The Okiru botnet is a variant of Mirai designed primarily to compromise Internet of Things (IoT) devices—especially those using specific ARC CPU architectures—by exploiting weak/default credentials and known vulnerabilities, then enrolling them into a large distributed network that can be used for powerful DDoS attacks. Once devices are infected, they typically connect out to a command-and-control (C2) server to receive instructions for which targets to flood and what attack methods to use (e.g., TCP/UDP floods). Common signs that Okiru or a similar IoT botnet is active in your environment include lots of outbound connections from cheap/embedded devices (cameras, DVRs, routers) to unusual external IPs or ports, devices initiating connections on ports they don’t normally use, sudden spikes in outbound traffic volume (especially uniform UDP or TCP packets) toward a single target or small set of targets, IDS/IPS alerts tied to Mirai-like signatures, and IoT devices becoming sluggish or unstable because their resources are being consumed by ongoing DDoS traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Okiru attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",Okiru,1313012,6046623,label,ChatGPT5 (Auto),4,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND (proto ILIKE 'tcp' OR proto ILIKE 'udp')
AND conn_state IN ('S0','SF')
AND orig_bytes >= 10 * GREATEST(1, resp_bytes)
AND (
SELECT COUNT(*)
FROM iot_23 s
WHERE s.""id.orig_h"" = t.""id.orig_h""
AND s.""id.resp_h"" = t.""id.resp_h""
AND s.ts BETWEEN t.ts - 300 AND t.ts + 300
) >= 150;",,
"This is when a row shows signs of both C&C and FileDownload
FileDownload: Filedownload is when a file is being downloaded to our infected device. This is detected by filtering connections with response bytes more than 3KB or 5KB, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server.
C&C: C&C (Command & control) means an infected device was connected to a C&C server. This activity was detected in the analysis of the network malware capture because the connections to the suspicious server are periodic or our infected device is downloading some binaries from it or some IRC like or decoded orders are coming and going from it. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-FileDownload attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-FileDownload,46,6046623,label,ChatGPT5 (Auto),1,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND resp_bytes >= 5000
AND (
SELECT COUNT(*)
FROM iot_23 c
WHERE c.""id.orig_h"" = t.""id.orig_h""
AND c.""id.resp_h"" = t.""id.resp_h""
AND c.""id.resp_p"" = t.""id.resp_p""
AND FLOOR(c.ts / 600) = FLOOR(t.ts / 600)
) >= 5;",,
"This is when a row shows signs of both C&C and FileDownload
FileDownload: Filedownload is when a file is being downloaded to our infected device. This is detected by filtering connections with response bytes more than 3KB or 5KB, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server.
C&C: C&C (Command & control) means an infected device was connected to a C&C server. This activity was detected in the analysis of the network malware capture because the connections to the suspicious server are periodic or our infected device is downloading some binaries from it or some IRC like or decoded orders are coming and going from it. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-FileDownload attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-FileDownload,46,6046623,label,ChatGPT5 (Auto),2,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND resp_bytes >= 3000
AND (service ILIKE 'http%' OR service ILIKE 'https%' OR service ILIKE 'ftp%' OR ""id.resp_p"" IN (8081, 4443, 8000, 9001, 1337, 6667, 12345))
AND (
SELECT COUNT(DISTINCT FLOOR(c.ts / 900))
FROM iot_23 c
WHERE c.""id.orig_h"" = t.""id.orig_h""
AND c.""id.resp_h"" = t.""id.resp_h""
AND c.""id.resp_p"" = t.""id.resp_p""
AND c.ts BETWEEN t.ts - 86400 AND t.ts + 86400
) >= 4;",,
"This is when a row shows signs of both C&C and FileDownload
FileDownload: Filedownload is when a file is being downloaded to our infected device. This is detected by filtering connections with response bytes more than 3KB or 5KB, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server.
C&C: C&C (Command & control) means an infected device was connected to a C&C server. This activity was detected in the analysis of the network malware capture because the connections to the suspicious server are periodic or our infected device is downloading some binaries from it or some IRC like or decoded orders are coming and going from it. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-FileDownload attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-FileDownload,46,6046623,label,ChatGPT5 (Auto),3,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND resp_bytes >= 4000
AND duration >= 10
AND (
SELECT COUNT(*)
FROM iot_23 c
WHERE c.""id.orig_h"" = t.""id.orig_h""
AND c.""id.resp_h"" = t.""id.resp_h""
AND c.""id.resp_p"" = t.""id.resp_p""
AND c.resp_bytes BETWEEN 0 AND 200
AND c.ts BETWEEN t.ts - 7200 AND t.ts + 7200
) >= 10;",,
"This is when a row shows signs of both C&C and FileDownload
FileDownload: Filedownload is when a file is being downloaded to our infected device. This is detected by filtering connections with response bytes more than 3KB or 5KB, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server.
C&C: C&C (Command & control) means an infected device was connected to a C&C server. This activity was detected in the analysis of the network malware capture because the connections to the suspicious server are periodic or our infected device is downloading some binaries from it or some IRC like or decoded orders are coming and going from it. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-FileDownload attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-FileDownload,46,6046623,label,ChatGPT5 (Auto),4,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND resp_bytes >= 3000
AND (
SELECT COUNT()
FROM iot_23 w
WHERE w.""id.orig_h"" = t.""id.orig_h""
AND w.""id.resp_h"" = t.""id.resp_h""
AND w.""id.resp_p"" = t.""id.resp_p""
AND w.ts BETWEEN t.ts - 43200 AND t.ts + 43200
) >= 20
AND (
SELECT COUNT()
FROM iot_23 b
WHERE b.""id.orig_h"" = t.""id.orig_h""
AND b.""id.resp_h"" = t.""id.resp_h""
AND b.""id.resp_p"" = t.""id.resp_p""
AND b.resp_bytes >= 3000
AND b.ts BETWEEN t.ts - 43200 AND t.ts + 43200
) >= 3;",,
"Partofahorizontalportscan means that the connections are used to do a horizontal port scan to gather information to perform further attacks. Find the pattern in which the connections shared the same port, a similar number of transmitted bytes and multiple different destination IPs. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Partofahorizontalportscan attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",PartOfAHorizontalPortScan,3389036,6046623,label,ChatGPT5 (Auto),1,"ChatGPT said:SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND orig_bytes BETWEEN 40 AND 800
AND COALESCE(resp_bytes, 0) <= 200
AND duration < 2
AND (
SELECT COUNT(DISTINCT t2.""id.resp_h"")
FROM iot_23 t2
WHERE t2.""id.orig_h"" = t.""id.orig_h""
AND t2.""id.resp_p"" = t.""id.resp_p""
AND t2.ts BETWEEN t.ts - 120 AND t.ts + 120
AND ABS(t2.orig_bytes - t.orig_bytes) <= 150
) >= 15;",,
"Partofahorizontalportscan means that the connections are used to do a horizontal port scan to gather information to perform further attacks. Find the pattern in which the connections shared the same port, a similar number of transmitted bytes and multiple different destination IPs. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Partofahorizontalportscan attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",PartOfAHorizontalPortScan,3389036,6046623,label,ChatGPT5 (Auto),2,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND proto ILIKE 'tcp'
AND COALESCE(resp_bytes, 0) = 0
AND orig_pkts BETWEEN 1 AND 5
AND duration < 1.5
AND (
SELECT COUNT(DISTINCT t2.""id.resp_h"")
FROM iot_23 t2
WHERE t2.""id.orig_h"" = t.""id.orig_h""
AND t2.""id.resp_p"" = t.""id.resp_p""
AND t2.ts BETWEEN t.ts - 60 AND t.ts + 60
AND ABS(t2.orig_bytes - t.orig_bytes) <= 200
) >= 20;",,
"Partofahorizontalportscan means that the connections are used to do a horizontal port scan to gather information to perform further attacks. Find the pattern in which the connections shared the same port, a similar number of transmitted bytes and multiple different destination IPs. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Partofahorizontalportscan attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",PartOfAHorizontalPortScan,3389036,6046623,label,ChatGPT5 (Auto),3,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND EXISTS (
SELECT 1
FROM (
SELECT s.""id.orig_h"" AS oh, s.""id.resp_p"" AS rp
FROM iot_23 s
WHERE COALESCE(s.local_orig, 0) = 1
GROUP BY s.""id.orig_h"", s.""id.resp_p""
HAVING COUNT(DISTINCT s.""id.resp_h"") >= 30
AND MAX(s.orig_bytes) - MIN(s.orig_bytes) <= 500
) g
WHERE g.oh = t.""id.orig_h""
AND g.rp = t.""id.resp_p""
);",,
"Partofahorizontalportscan means that the connections are used to do a horizontal port scan to gather information to perform further attacks. Find the pattern in which the connections shared the same port, a similar number of transmitted bytes and multiple different destination IPs. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Partofahorizontalportscan attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",PartOfAHorizontalPortScan,3389036,6046623,label,ChatGPT5 (Auto),4,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND orig_bytes BETWEEN 100 AND 1000
AND COALESCE(resp_bytes, 0) <= 100
AND duration < 2
AND (
SELECT COUNT(DISTINCT FLOOR(t2.ts / 60))
FROM iot_23 t2
WHERE t2.""id.orig_h"" = t.""id.orig_h""
AND t2.""id.resp_p"" = t.""id.resp_p""
AND t2.orig_bytes BETWEEN t.orig_bytes - 200 AND t.orig_bytes + 200
) >= 5
AND (
SELECT COUNT(DISTINCT t3.""id.resp_h"")
FROM iot_23 t3
WHERE t3.""id.orig_h"" = t.""id.orig_h""
AND t3.""id.resp_p"" = t.""id.resp_p""
AND t3.orig_bytes BETWEEN t.orig_bytes - 200 AND t.orig_bytes + 200
) >= 25;",,
"This is when a row shows signs of both Okiru and an attack. 
Okiru: The Okiru botnet is a variant of Mirai designed primarily to compromise Internet of Things (IoT) devices—especially those using specific ARC CPU architectures—by exploiting weak/default credentials and known vulnerabilities, then enrolling them into a large distributed network that can be used for powerful DDoS attacks. Once devices are infected, they typically connect out to a command-and-control (C2) server to receive instructions for which targets to flood and what attack methods to use (e.g., TCP/UDP floods). Common signs that Okiru or a similar IoT botnet is active in your environment include lots of outbound connections from cheap/embedded devices (cameras, DVRs, routers) to unusual external IPs or ports, devices initiating connections on ports they don’t normally use, sudden spikes in outbound traffic volume (especially uniform UDP or TCP packets) toward a single target or small set of targets, IDS/IPS alerts tied to Mirai-like signatures, and IoT devices becoming sluggish or unstable because their resources are being consumed by ongoing DDoS traffic.
Attack: An attack means that there was some type of attack from an infected device to another host. These include flows that try to take advantage of some vulnerable service, for example a brute force to some telnet login, a command injection in the header of a GET request, etc. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Okiru-Attack attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",Okiru-Attack,3,6046623,label,ChatGPT5 (Auto),1,"SELECT * FROM iot_23 t
WHERE COALESCE(t.local_orig, 0) = 1
AND (t.service ILIKE 'telnet' OR t.""id.resp_p"" IN (23, 2323))
AND t.conn_state IN ('S0','REJ')
AND COALESCE(t.resp_bytes, 0) = 0
AND (
SELECT COUNT(*)
FROM iot_23 u
WHERE u.""id.orig_h"" = t.""id.orig_h""
AND u.proto ILIKE 'udp'
AND u.conn_state IN ('S0','SF')
AND u.duration < 2
AND COALESCE(u.resp_pkts, 0) = 0
AND u.ts BETWEEN t.ts - 120 AND t.ts + 120
) >= 100",,
"This is when a row shows signs of both Okiru and an attack. 
Okiru: The Okiru botnet is a variant of Mirai designed primarily to compromise Internet of Things (IoT) devices—especially those using specific ARC CPU architectures—by exploiting weak/default credentials and known vulnerabilities, then enrolling them into a large distributed network that can be used for powerful DDoS attacks. Once devices are infected, they typically connect out to a command-and-control (C2) server to receive instructions for which targets to flood and what attack methods to use (e.g., TCP/UDP floods). Common signs that Okiru or a similar IoT botnet is active in your environment include lots of outbound connections from cheap/embedded devices (cameras, DVRs, routers) to unusual external IPs or ports, devices initiating connections on ports they don’t normally use, sudden spikes in outbound traffic volume (especially uniform UDP or TCP packets) toward a single target or small set of targets, IDS/IPS alerts tied to Mirai-like signatures, and IoT devices becoming sluggish or unstable because their resources are being consumed by ongoing DDoS traffic.
Attack: An attack means that there was some type of attack from an infected device to another host. These include flows that try to take advantage of some vulnerable service, for example a brute force to some telnet login, a command injection in the header of a GET request, etc. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Okiru-Attack attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",Okiru-Attack,3,6046623,label,ChatGPT5 (Auto),2,"SELECT * FROM iot_23 t
WHERE COALESCE(t.local_orig, 0) = 1
AND (t.service ILIKE 'http%' OR t.""id.resp_p"" IN (80, 8080, 7547))
AND t.duration < 2
AND t.orig_bytes >= 5 * GREATEST(1, t.resp_bytes) + 1000
AND (
SELECT COUNT()
FROM iot_23 c
WHERE c.""id.orig_h"" = t.""id.orig_h""
AND c.""id.resp_h"" = t.""id.resp_h""
AND c.""id.resp_p"" = t.""id.resp_p""
AND (c.service ILIKE 'http%' OR c.""id.resp_p"" IN (80, 8080, 7547))
AND c.ts BETWEEN t.ts - 120 AND t.ts + 120
) >= 10
AND (
SELECT COUNT()
FROM iot_23 x
WHERE x.""id.orig_h"" = t.""id.orig_h""
AND (x.service IS NULL OR x.service IN ('', '-', 'unknown'))
AND x.""id.resp_p"" >= 1024
AND x.""id.resp_p"" NOT IN (80,443,53,123,22,25,110,143,993,995,587,21,23,2323,445,1433,3306,8080)
AND COALESCE(x.resp_bytes, 0) <= 200
AND x.ts BETWEEN t.ts - 3600 AND t.ts + 3600
) >= 20",,
"This is when a row shows signs of both Okiru and an attack. 
Okiru: The Okiru botnet is a variant of Mirai designed primarily to compromise Internet of Things (IoT) devices—especially those using specific ARC CPU architectures—by exploiting weak/default credentials and known vulnerabilities, then enrolling them into a large distributed network that can be used for powerful DDoS attacks. Once devices are infected, they typically connect out to a command-and-control (C2) server to receive instructions for which targets to flood and what attack methods to use (e.g., TCP/UDP floods). Common signs that Okiru or a similar IoT botnet is active in your environment include lots of outbound connections from cheap/embedded devices (cameras, DVRs, routers) to unusual external IPs or ports, devices initiating connections on ports they don’t normally use, sudden spikes in outbound traffic volume (especially uniform UDP or TCP packets) toward a single target or small set of targets, IDS/IPS alerts tied to Mirai-like signatures, and IoT devices becoming sluggish or unstable because their resources are being consumed by ongoing DDoS traffic.
Attack: An attack means that there was some type of attack from an infected device to another host. These include flows that try to take advantage of some vulnerable service, for example a brute force to some telnet login, a command injection in the header of a GET request, etc. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Okiru-Attack attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",Okiru-Attack,3,6046623,label,ChatGPT5 (Auto),3,"SELECT * FROM iot_23 t
WHERE COALESCE(t.local_orig, 0) = 1
AND (t.proto ILIKE 'udp' OR t.proto ILIKE 'tcp')
AND t.duration < 2
AND t.orig_bytes >= 10 * GREATEST(1, t.resp_bytes)
AND (
SELECT COUNT(*)
FROM iot_23 f
WHERE f.""id.orig_h"" = t.""id.orig_h""
AND f.""id.resp_h"" = t.""id.resp_h""
AND f.ts BETWEEN t.ts - 60 AND t.ts + 60
) >= 100
AND (
SELECT COUNT(DISTINCT z.""id.resp_p"")
FROM iot_23 z
WHERE z.""id.orig_h"" = t.""id.orig_h""
AND z.""id.resp_p"" >= 1024
AND z.""id.resp_p"" NOT IN (80,443,53,123,22,25,110,143,993,995,587,21,23,2323,445,1433,3306,8080)
AND COALESCE(z.resp_bytes, 0) <= 200
AND z.ts BETWEEN t.ts - 7200 AND t.ts + 7200
) >= 10",,
"This is when a row shows signs of both Okiru and an attack. 
Okiru: The Okiru botnet is a variant of Mirai designed primarily to compromise Internet of Things (IoT) devices—especially those using specific ARC CPU architectures—by exploiting weak/default credentials and known vulnerabilities, then enrolling them into a large distributed network that can be used for powerful DDoS attacks. Once devices are infected, they typically connect out to a command-and-control (C2) server to receive instructions for which targets to flood and what attack methods to use (e.g., TCP/UDP floods). Common signs that Okiru or a similar IoT botnet is active in your environment include lots of outbound connections from cheap/embedded devices (cameras, DVRs, routers) to unusual external IPs or ports, devices initiating connections on ports they don’t normally use, sudden spikes in outbound traffic volume (especially uniform UDP or TCP packets) toward a single target or small set of targets, IDS/IPS alerts tied to Mirai-like signatures, and IoT devices becoming sluggish or unstable because their resources are being consumed by ongoing DDoS traffic.
Attack: An attack means that there was some type of attack from an infected device to another host. These include flows that try to take advantage of some vulnerable service, for example a brute force to some telnet login, a command injection in the header of a GET request, etc. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the Okiru-Attack attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",Okiru-Attack,3,6046623,label,ChatGPT5 (Auto),4,"SELECT * FROM iot_23 t
WHERE COALESCE(t.local_orig, 0) = 1
AND (t.proto ILIKE 'udp' OR t.proto ILIKE 'tcp')
AND t.conn_state IN ('SF','S1')
AND t.orig_bytes >= 5 * GREATEST(1, t.resp_bytes)
AND (
SELECT COUNT()
FROM iot_23 s
WHERE s.""id.orig_h"" = t.""id.orig_h""
AND (s.service ILIKE 'telnet' OR s.""id.resp_p"" IN (23, 2323))
AND s.conn_state IN ('S0','REJ')
AND COALESCE(s.resp_bytes, 0) = 0
AND s.ts BETWEEN t.ts - 3600 AND t.ts
) >= 30
AND (
SELECT COUNT()
FROM iot_23 d
WHERE d.""id.orig_h"" = t.""id.orig_h""
AND d.""id.resp_h"" = t.""id.resp_h""
AND d.ts BETWEEN t.ts - 120 AND t.ts + 120
) >= 50",,
"C&C (Command & control) means an infected device was connected to a C&C server. This activity was detected in the analysis of the network malware capture because the connections to the suspicious server are periodic or our infected device is downloading some binaries from it or some IRC like or decoded orders are coming and going from it. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C,15286,6046623,label,ChatGPT5 (Auto),1,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND COALESCE(resp_bytes, 0) <= 200
AND (
SELECT COUNT(DISTINCT FLOOR(b.ts / 300))
FROM iot_23 b
WHERE b.""id.orig_h"" = t.""id.orig_h""
AND b.""id.resp_h"" = t.""id.resp_h""
AND b.""id.resp_p"" = t.""id.resp_p""
AND COALESCE(b.resp_bytes, 0) <= 200
) >= 8;",,
"C&C (Command & control) means an infected device was connected to a C&C server. This activity was detected in the analysis of the network malware capture because the connections to the suspicious server are periodic or our infected device is downloading some binaries from it or some IRC like or decoded orders are coming and going from it. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C,15286,6046623,label,ChatGPT5 (Auto),2,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND (
SELECT COUNT(*)
FROM iot_23 c
WHERE c.""id.orig_h"" = t.""id.orig_h""
AND c.""id.resp_h"" = t.""id.resp_h""
AND c.""id.resp_p"" = t.""id.resp_p""
AND c.ts BETWEEN t.ts - 1800 AND t.ts + 1800
) >= 30
AND duration BETWEEN 5 AND 900
AND COALESCE(resp_bytes, 0) BETWEEN 50 AND 2000;",,
"C&C (Command & control) means an infected device was connected to a C&C server. This activity was detected in the analysis of the network malware capture because the connections to the suspicious server are periodic or our infected device is downloading some binaries from it or some IRC like or decoded orders are coming and going from it. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C,15286,6046623,label,ChatGPT5 (Auto),3,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND resp_bytes >= 3000
AND (service ILIKE 'http%' OR service ILIKE 'https%' OR service ILIKE 'ftp%')
AND (
SELECT COUNT(*)
FROM iot_23 b
WHERE b.""id.orig_h"" = t.""id.orig_h""
AND b.""id.resp_h"" = t.""id.resp_h""
AND b.""id.resp_p"" = t.""id.resp_p""
AND COALESCE(b.resp_bytes, 0) <= 200
AND b.ts BETWEEN t.ts - 86400 AND t.ts + 86400
) >= 10;",,
"C&C (Command & control) means an infected device was connected to a C&C server. This activity was detected in the analysis of the network malware capture because the connections to the suspicious server are periodic or our infected device is downloading some binaries from it or some IRC like or decoded orders are coming and going from it. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C,15286,6046623,label,ChatGPT5 (Auto),4,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND (service IS NULL OR service IN ('', '-', 'unknown'))
AND ""id.resp_p"" >= 1024
AND ""id.resp_p"" NOT IN (80,443,53,123,22,25,110,143,993,995,587,21,23,2323,445,1433,3306,8080)
AND (
SELECT COUNT(DISTINCT FLOOR(c.ts / 600))
FROM iot_23 c
WHERE c.""id.orig_h"" = t.""id.orig_h""
AND c.""id.resp_h"" = t.""id.resp_h""
AND c.""id.resp_p"" = t.""id.resp_p""
) >= 6
AND (
SELECT COUNT(*)
FROM iot_23 d
WHERE d.""id.orig_h"" = t.""id.orig_h""
AND d.""id.resp_h"" = t.""id.resp_h""
AND d.""id.resp_p"" = t.""id.resp_p""
AND d.ts BETWEEN t.ts - 3600 AND t.ts + 3600
) >= 20;",,
"Packets sent as a part of a C&C-heartbeat are used to keep a track on the infected host by the C&C server. This was detected by filtering connections with response bytes lower than 1B and with periodic similar connections, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-HeartBeat attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-HeartBeat,1332,6046623,label,ChatGPT5 (Auto),1,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND COALESCE(resp_bytes, 0) <= 1
AND (
SELECT COUNT(*)
FROM iot_23 hb
WHERE hb.""id.orig_h"" = t.""id.orig_h""
AND hb.""id.resp_h"" = t.""id.resp_h""
AND hb.""id.resp_p"" = t.""id.resp_p""
AND COALESCE(hb.resp_bytes, 0) <= 1
AND FLOOR(hb.ts / 300) = FLOOR(t.ts / 300)
) >= 5;",,
"Packets sent as a part of a C&C-heartbeat are used to keep a track on the infected host by the C&C server. This was detected by filtering connections with response bytes lower than 1B and with periodic similar connections, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-HeartBeat attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-HeartBeat,1332,6046623,label,ChatGPT5 (Auto),2,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND COALESCE(resp_bytes, 0) <= 1
AND (
SELECT COUNT(DISTINCT FLOOR(hb.ts / 600))
FROM iot_23 hb
WHERE hb.""id.orig_h"" = t.""id.orig_h""
AND hb.""id.resp_h"" = t.""id.resp_h""
AND hb.""id.resp_p"" = t.""id.resp_p""
AND COALESCE(hb.resp_bytes, 0) <= 1
AND hb.ts BETWEEN t.ts - 86400 AND t.ts + 86400
) >= 6;",,
"Packets sent as a part of a C&C-heartbeat are used to keep a track on the infected host by the C&C server. This was detected by filtering connections with response bytes lower than 1B and with periodic similar connections, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-HeartBeat attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-HeartBeat,1332,6046623,label,ChatGPT5 (Auto),3,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND COALESCE(resp_bytes, 0) <= 1
AND (
service IS NULL OR service IN ('', '-', 'unknown')
OR ""id.resp_p"" IN (6667, 6697, 5555, 1337, 12345, 9001)
)
AND (
SELECT COUNT(*)
FROM iot_23 hb
WHERE hb.""id.orig_h"" = t.""id.orig_h""
AND hb.""id.resp_h"" = t.""id.resp_h""
AND hb.""id.resp_p"" = t.""id.resp_p""
AND COALESCE(hb.resp_bytes, 0) <= 1
AND hb.ts BETWEEN t.ts - 3600 AND t.ts + 3600
) >= 10;",,
"Packets sent as a part of a C&C-heartbeat are used to keep a track on the infected host by the C&C server. This was detected by filtering connections with response bytes lower than 1B and with periodic similar connections, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-HeartBeat attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-HeartBeat,1332,6046623,label,ChatGPT5 (Auto),4,"SELECT * FROM iot_23 t
WHERE COALESCE(local_orig, 0) = 1
AND COALESCE(resp_bytes, 0) <= 1
AND EXISTS (
SELECT 1
FROM (
SELECT
""id.orig_h"" AS oh,
""id.resp_h"" AS rh,
""id.resp_p"" AS rp,
COUNT(*) AS total_flows,
SUM(CASE WHEN COALESCE(resp_bytes, 0) <= 1 THEN 1 ELSE 0 END) AS hb_flows
FROM iot_23
WHERE COALESCE(local_orig, 0) = 1
GROUP BY ""id.orig_h"", ""id.resp_h"", ""id.resp_p""
HAVING total_flows >= 30
AND hb_flows >= 0.8 * total_flows
) agg
WHERE agg.oh = t.""id.orig_h""
AND agg.rh = t.""id.resp_h""
AND agg.rp = t.""id.resp_p""
);",,
"The Mirai botnet is a famous piece of malware that infects internet-connected devices (especially IoT gear like cameras, DVRs, and home routers) by scanning the internet for systems with open ports and weak or default credentials, then hijacking them and enrolling them into a large, remotely controlled network used mainly for massive DDoS attacks. Once devices are compromised, they phone home to command-and-control servers, which coordinate floods like TCP, UDP, or HTTP request storms against chosen targets. Common signs that Mirai (or a Mirai-like botnet) is active in a network attack include huge spikes in outbound traffic from cheap/embedded devices, lots of similar-sized packets heading to a single destination or small set of IPs, unusual outbound connections from IoT devices on ports they don’t normally use, IDS/IPS alerts that match Mirai signatures or known scanning behavior (e.g., repeated probes on Telnet/SSH ports), and those devices suddenly becoming sluggish, overheating, or frequently rebooting because their resources are being consumed by attack traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-Mirai attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-Mirai,1,6046623,label,ChatGPT5 (Auto),1,"ChatGPT said:SELECT * FROM iot_23 t
WHERE COALESCE(t.local_orig, 0) = 1
AND (
SELECT COUNT()
FROM iot_23 c
WHERE c.""id.orig_h"" = t.""id.orig_h""
AND c.""id.resp_h"" = t.""id.resp_h""
AND c.""id.resp_p"" = t.""id.resp_p""
AND COALESCE(c.resp_bytes, 0) BETWEEN 0 AND 400
AND c.ts BETWEEN t.ts - 3600 AND t.ts + 3600
) >= 10
AND EXISTS (
SELECT 1
FROM iot_23 s
WHERE s.""id.orig_h"" = t.""id.orig_h""
AND s.""id.resp_p"" IN (23, 2323)
AND s.conn_state IN ('S0','REJ')
AND COALESCE(s.resp_bytes, 0) = 0
AND s.ts BETWEEN t.ts - 86400 AND t.ts + 86400
GROUP BY s.""id.orig_h""
HAVING COUNT() >= 50
);",,
"The Mirai botnet is a famous piece of malware that infects internet-connected devices (especially IoT gear like cameras, DVRs, and home routers) by scanning the internet for systems with open ports and weak or default credentials, then hijacking them and enrolling them into a large, remotely controlled network used mainly for massive DDoS attacks. Once devices are compromised, they phone home to command-and-control servers, which coordinate floods like TCP, UDP, or HTTP request storms against chosen targets. Common signs that Mirai (or a Mirai-like botnet) is active in a network attack include huge spikes in outbound traffic from cheap/embedded devices, lots of similar-sized packets heading to a single destination or small set of IPs, unusual outbound connections from IoT devices on ports they don’t normally use, IDS/IPS alerts that match Mirai signatures or known scanning behavior (e.g., repeated probes on Telnet/SSH ports), and those devices suddenly becoming sluggish, overheating, or frequently rebooting because their resources are being consumed by attack traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-Mirai attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-Mirai,1,6046623,label,ChatGPT5 (Auto),2,"SELECT * FROM iot_23 t
WHERE COALESCE(t.local_orig, 0) = 1
AND t.proto ILIKE 'udp'
AND COALESCE(t.resp_pkts, 0) = 0
AND t.duration < 2
AND (
SELECT COUNT(*)
FROM iot_23 u
WHERE u.""id.orig_h"" = t.""id.orig_h""
AND u.""id.resp_h"" = t.""id.resp_h""
AND u.proto ILIKE 'udp'
AND u.ts BETWEEN t.ts - 60 AND t.ts + 60
) >= 150
AND EXISTS (
SELECT 1
FROM iot_23 b
WHERE b.""id.orig_h"" = t.""id.orig_h""
AND b.""id.resp_p"" >= 1024
AND (b.service IS NULL OR b.service IN ('', '-', 'unknown'))
AND COALESCE(b.resp_bytes, 0) BETWEEN 0 AND 400
GROUP BY b.""id.orig_h"", b.""id.resp_h"", b.""id.resp_p""
HAVING COUNT(DISTINCT FLOOR(b.ts / 600)) >= 4
);",,
"The Mirai botnet is a famous piece of malware that infects internet-connected devices (especially IoT gear like cameras, DVRs, and home routers) by scanning the internet for systems with open ports and weak or default credentials, then hijacking them and enrolling them into a large, remotely controlled network used mainly for massive DDoS attacks. Once devices are compromised, they phone home to command-and-control servers, which coordinate floods like TCP, UDP, or HTTP request storms against chosen targets. Common signs that Mirai (or a Mirai-like botnet) is active in a network attack include huge spikes in outbound traffic from cheap/embedded devices, lots of similar-sized packets heading to a single destination or small set of IPs, unusual outbound connections from IoT devices on ports they don’t normally use, IDS/IPS alerts that match Mirai signatures or known scanning behavior (e.g., repeated probes on Telnet/SSH ports), and those devices suddenly becoming sluggish, overheating, or frequently rebooting because their resources are being consumed by attack traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-Mirai attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-Mirai,1,6046623,label,ChatGPT5 (Auto),3,"SELECT * FROM iot_23 t
WHERE COALESCE(t.local_orig, 0) = 1
AND (t.service ILIKE 'http%' OR t.service ILIKE 'https%')
AND t.resp_bytes BETWEEN 500 AND 4000
AND t.duration BETWEEN 5 AND 900
AND (
SELECT COUNT(DISTINCT FLOOR(c.ts / 900))
FROM iot_23 c
WHERE c.""id.orig_h"" = t.""id.orig_h""
AND c.""id.resp_h"" = t.""id.resp_h""
AND c.""id.resp_p"" = t.""id.resp_p""
) >= 3
AND EXISTS (
SELECT 1
FROM iot_23 a
WHERE a.""id.orig_h"" = t.""id.orig_h""
AND (a.proto ILIKE 'tcp' OR a.proto ILIKE 'udp')
AND a.duration < 2
AND a.orig_bytes >= 10 * GREATEST(1, a.resp_bytes)
AND a.ts BETWEEN t.ts - 600 AND t.ts + 600
GROUP BY a.""id.orig_h"", a.""id.resp_h""
HAVING COUNT(*) >= 100
);",,
"The Mirai botnet is a famous piece of malware that infects internet-connected devices (especially IoT gear like cameras, DVRs, and home routers) by scanning the internet for systems with open ports and weak or default credentials, then hijacking them and enrolling them into a large, remotely controlled network used mainly for massive DDoS attacks. Once devices are compromised, they phone home to command-and-control servers, which coordinate floods like TCP, UDP, or HTTP request storms against chosen targets. Common signs that Mirai (or a Mirai-like botnet) is active in a network attack include huge spikes in outbound traffic from cheap/embedded devices, lots of similar-sized packets heading to a single destination or small set of IPs, unusual outbound connections from IoT devices on ports they don’t normally use, IDS/IPS alerts that match Mirai signatures or known scanning behavior (e.g., repeated probes on Telnet/SSH ports), and those devices suddenly becoming sluggish, overheating, or frequently rebooting because their resources are being consumed by attack traffic. Give me 4 different duckdb sql compatible queries that will find all rows that show signs of the C&C-Mirai attack in the table. You may use any valid duckdb sql functions and must include all columns in the output. Do not include any text in the output except for the 4 queries.
SQL Context:
CREATE TABLE iot_23 (""ts"" DOUBLE, ""uid"" VARCHAR, ""id.orig_h"" VARCHAR, ""id.orig_p"" BIGINT, ""id.resp_h"" VARCHAR, ""id.resp_p"" BIGINT, ""proto"" VARCHAR, ""service"" VARCHAR, ""duration"" DOUBLE, ""orig_bytes"" BIGINT, ""resp_bytes"" BIGINT, ""conn_state"" VARCHAR, ""local_orig"" DOUBLE, ""local_resp"" DOUBLE, ""missed_bytes"" BIGINT, ""history"" VARCHAR, ""orig_pkts"" BIGINT, ""orig_ip_bytes"" BIGINT, ""resp_pkts"" BIGINT, ""resp_ip_bytes"" BIGINT)",C&C-Mirai,1,6046623,label,ChatGPT5 (Auto),4,"SELECT * FROM iot_23 t
WHERE COALESCE(t.local_orig, 0) = 1
AND COALESCE(t.resp_bytes, 0) <= 400
AND (
SELECT COUNT()
FROM iot_23 c
WHERE c.""id.orig_h"" = t.""id.orig_h""
AND c.""id.resp_h"" = t.""id.resp_h""
AND c.""id.resp_p"" = t.""id.resp_p""
AND COALESCE(c.resp_bytes, 0) <= 400
AND c.ts BETWEEN t.ts - 43200 AND t.ts + 43200
) >= 20
AND EXISTS (
SELECT 1
FROM iot_23 d
WHERE d.""id.orig_h"" = t.""id.orig_h""
AND (d.service ILIKE 'telnet' OR d.""id.resp_p"" IN (23, 2323))
AND d.conn_state IN ('S0','REJ')
AND COALESCE(d.resp_bytes, 0) = 0
GROUP BY d.""id.orig_h""
HAVING COUNT() >= 30
);",,